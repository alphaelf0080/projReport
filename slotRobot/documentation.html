<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slot Robot - 架構說明與使用手冊</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
            margin-bottom: 20px;
        }

        .header {
            text-align: center;
            padding: 40px 0;
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .nav-tabs {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 30px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 10px;
        }

        .nav-tab {
            padding: 12px 24px;
            margin: 5px;
            background: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .nav-tab:hover {
            background: #007bff;
            color: white;
            transform: translateY(-2px);
        }

        .nav-tab.active {
            background: #007bff;
            color: white;
            box-shadow: 0 4px 15px rgba(0,123,255,0.3);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .architecture-diagram {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .flowchart {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin: 30px 0;
        }

        .flow-step {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            border-radius: 15px;
            text-align: center;
            min-width: 200px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            position: relative;
        }

        .flow-step::after {
            content: '↓';
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            color: #667eea;
        }

        .flow-step:last-child::after {
            display: none;
        }

        .config-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .config-table th,
        .config-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .config-table th {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            font-weight: bold;
        }

        .config-table tr:hover {
            background: #f5f5f5;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .feature-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-card i {
            font-size: 3em;
            color: #4CAF50;
            margin-bottom: 20px;
        }

        .feature-card h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .code-block {
            background: #f8f9fa;
            border-left: 4px solid #4CAF50;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }

        .file-structure {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
        }

        .file-structure .folder {
            color: #f39c12;
            font-weight: bold;
        }

        .file-structure .file {
            color: #3498db;
            margin-left: 20px;
        }

        .alert {
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid;
        }

        .alert-info {
            background: #d1ecf1;
            border-color: #bee5eb;
            color: #0c5460;
        }

        .alert-warning {
            background: #fff3cd;
            border-color: #ffeaa7;
            color: #856404;
        }

        .alert-success {
            background: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-connected { background: #4CAF50; }
        .status-disconnected { background: #f44336; }
        .status-reconnecting { background: #ff9800; }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #4CAF50;
        }

        .stat-label {
            color: #666;
            margin-top: 5px;
        }

        .interactive-demo {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .demo-button {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .demo-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .demo-output {
            background: #2d3748;
            color: #a0aec0;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            text-align: left;
            min-height: 100px;
            max-height: 300px;
            overflow-y: auto;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-robot"></i> Slot Robot</h1>
            <p>老虎機遊戲自動化測試工具 - 架構說明與使用手冊</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('overview')">
                <i class="fas fa-home"></i> 概覽
            </button>
            <button class="nav-tab" onclick="showTab('architecture')">
                <i class="fas fa-sitemap"></i> 系統架構
            </button>
            <button class="nav-tab" onclick="showTab('configuration')">
                <i class="fas fa-cogs"></i> 配置說明
            </button>
            <button class="nav-tab" onclick="showTab('workflow')">
                <i class="fas fa-project-diagram"></i> 工作流程
            </button>
            <button class="nav-tab" onclick="showTab('usage')">
                <i class="fas fa-play"></i> 使用說明
            </button>
            <button class="nav-tab" onclick="showTab('monitoring')">
                <i class="fas fa-chart-line"></i> 監控面板
            </button>
            <button class="nav-tab" onclick="showTab('troubleshooting')">
                <i class="fas fa-wrench"></i> 故障排除
            </button>
        </div>

        <!-- 概覽 Tab -->
        <div id="overview" class="tab-content active">
            <div class="architecture-diagram">
                <h2><i class="fas fa-info-circle"></i> 系統概覽</h2>
                
                <div class="feature-grid">
                    <div class="feature-card">
                        <i class="fas fa-robot"></i>
                        <h3>自動化測試</h3>
                        <p>模擬真實玩家行為，自動執行遊戲操作並記錄結果</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-network-wired"></i>
                        <h3>斷線重連測試</h3>
                        <p>測試網路斷線後的重連機制和遊戲狀態恢復</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-chart-bar"></i>
                        <h3>數據分析</h3>
                        <p>詳細記錄遊戲過程，提供完整的數據分析報告</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-shield-alt"></i>
                        <h3>穩定性測試</h3>
                        <p>長時間運行測試，驗證系統穩定性和可靠性</p>
                    </div>
                </div>

                <div class="file-structure">
                    <h3><i class="fas fa-folder-open"></i> 項目文件結構</h3>
                    <pre>
slotRobotAI/
├── <span class="folder">📁 proto/</span>                     # Protocol Buffers 定義
│   ├── <span class="file">📄 game-v1.proto</span>
│   └── <span class="file">📄 module_command.proto</span>
├── <span class="folder">📁 lib/</span>                      # 第三方函式庫
│   ├── <span class="file">📄 ByteBufferAB.min.js</span>
│   ├── <span class="file">📄 jquery-2.1.4.min.js</span>
│   ├── <span class="file">📄 Long.min.js</span>
│   └── <span class="file">📄 ProtoBuf.min.js</span>
├── <span class="folder">📁 logs/</span>                     # 日誌文件目錄
│   └── <span class="file">📄 robot-YYYY-MM-DD.log</span>
├── <span class="file">📄 slot-robot.js</span>              # 主控制程式
├── <span class="file">📄 slot-client-v1.js</span>          # 客戶端核心邏輯
├── <span class="file">📄 slot-robot.json</span>            # 機器人配置
├── <span class="file">📄 slot-user-list.json</span>        # 測試帳號列表
├── <span class="file">📄 slot-game-list.json</span>        # 支援遊戲列表
├── <span class="file">📄 checkConnectionData.js</span>     # 數據驗證工具
└── <span class="file">📄 gameLog_*.json</span>             # 遊戲記錄文件
                    </pre>
                </div>

                <div class="alert alert-info">
                    <i class="fas fa-lightbulb"></i>
                    <strong>核心功能：</strong> 這個工具主要用於測試老虎機遊戲的穩定性、網路斷線恢復能力和遊戲數據的一致性。
                </div>
            </div>
        </div>

        <!-- 系統架構 Tab -->
        <div id="architecture" class="tab-content">
            <div class="architecture-diagram">
                <h2><i class="fas fa-sitemap"></i> 系統架構圖</h2>
                
                <div class="flowchart">
                    <div class="flow-step">
                        <h3><i class="fas fa-play"></i> 啟動控制器</h3>
                        <p>slot-robot.js<br>讀取配置文件，初始化測試環境</p>
                    </div>
                    <div class="flow-step">
                        <h3><i class="fas fa-users"></i> 客戶端管理</h3>
                        <p>建立多個虛擬客戶端<br>模擬真實玩家行為</p>
                    </div>
                    <div class="flow-step">
                        <h3><i class="fas fa-plug"></i> 網路連接</h3>
                        <p>WebSocket 連接遊戲伺服器<br>處理登入認證</p>
                    </div>
                    <div class="flow-step">
                        <h3><i class="fas fa-gamepad"></i> 遊戲執行</h3>
                        <p>自動執行遊戲操作<br>記錄所有遊戲事件</p>
                    </div>
                    <div class="flow-step">
                        <h3><i class="fas fa-wifi"></i> 斷線測試</h3>
                        <p>隨機觸發網路斷線<br>測試重連機制</p>
                    </div>
                    <div class="flow-step">
                        <h3><i class="fas fa-chart-line"></i> 數據分析</h3>
                        <p>驗證數據一致性<br>生成測試報告</p>
                    </div>
                </div>

                <h3><i class="fas fa-cogs"></i> 核心組件說明</h3>
                <table class="config-table">
                    <thead>
                        <tr>
                            <th>組件名稱</th>
                            <th>文件</th>
                            <th>功能描述</th>
                            <th>狀態</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>主控制器</strong></td>
                            <td>slot-robot.js</td>
                            <td>管理整個測試流程，控制客戶端生命周期</td>
                            <td><span class="status-indicator status-connected"></span>運行中</td>
                        </tr>
                        <tr>
                            <td><strong>遊戲客戶端</strong></td>
                            <td>slot-client-v1.js</td>
                            <td>模擬玩家行為，處理遊戲邏輯和網路通信</td>
                            <td><span class="status-indicator status-connected"></span>就緒</td>
                        </tr>
                        <tr>
                            <td><strong>協議處理</strong></td>
                            <td>proto/*.proto</td>
                            <td>定義客戶端與伺服器間的通信協議</td>
                            <td><span class="status-indicator status-connected"></span>已載入</td>
                        </tr>
                        <tr>
                            <td><strong>數據驗證</strong></td>
                            <td>checkConnectionData.js</td>
                            <td>驗證斷線重連後的數據一致性</td>
                            <td><span class="status-indicator status-connected"></span>可用</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 配置說明 Tab -->
        <div id="configuration" class="tab-content">
            <div class="architecture-diagram">
                <h2><i class="fas fa-cogs"></i> 配置文件說明</h2>
                
                <h3><i class="fas fa-file-code"></i> slot-robot.json - 主要配置</h3>
                <table class="config-table">
                    <thead>
                        <tr>
                            <th>配置項目</th>
                            <th>類型</th>
                            <th>說明</th>
                            <th>範例值</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>server</strong></td>
                            <td>String</td>
                            <td>WebSocket 伺服器地址</td>
                            <td>wss://dev-gs.iplaystar.net:83/slot</td>
                        </tr>
                        <tr>
                            <td><strong>signin_url</strong></td>
                            <td>String</td>
                            <td>登入 API 端點</td>
                            <td>https://dev.iplaystar.net/api/signin</td>
                        </tr>
                        <tr>
                            <td><strong>auto_reconnect</strong></td>
                            <td>Boolean</td>
                            <td>是否啟用自動重連</td>
                            <td>true</td>
                        </tr>
                        <tr>
                            <td><strong>random_disconnect_count</strong></td>
                            <td>Array</td>
                            <td>隨機斷線觸發次數範圍 [min, max]</td>
                            <td>[5, 7]</td>
                        </tr>
                        <tr>
                            <td><strong>number_of_disconnects</strong></td>
                            <td>Number</td>
                            <td>每個遊戲的斷線測試次數</td>
                            <td>30</td>
                        </tr>
                        <tr>
                            <td><strong>launch_interval</strong></td>
                            <td>Array</td>
                            <td>客戶端啟動間隔 [min, max] 毫秒</td>
                            <td>[5000, 10000]</td>
                        </tr>
                    </tbody>
                </table>

                <h3><i class="fas fa-robot"></i> 機器人配置</h3>
                <div class="code-block">
                    <pre>{
  "robots": [
    {
      "game_id": "PSS-ON-00001",      // 遊戲ID
      "subgame_id": 0,                // 子遊戲ID
      "bet_index": 0,                 // 投注索引
      "line_index": 0,                // 線數索引
      "rate_index": 0,                // 面額索引
      "delayTime": 50,                // 每次旋轉間隔(毫秒)
      "count": 1,                     // 機器人數量
      "multi_window": [0,0,0,0],      // 多視窗設定(可選)
      "select_volatility": 0,         // 難度選擇(可選)
      "select_spin_index": 0          // 重轉設定(可選)
    }
  ]
}</pre>
                </div>

                <h3><i class="fas fa-users"></i> 測試帳號配置</h3>
                <div class="code-block">
                    <pre>// slot-user-list.json
[
  {
    "id": "robot001",              // 帳號ID
    "pwd": "1234",                 // 密碼
    "host_prefix": "PS"            // 主機前綴
  }
]</pre>
                </div>

                <div class="alert alert-warning">
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>注意：</strong> 請確保測試帳號有足夠的餘額進行測試，建議使用專用的測試環境。
                </div>
            </div>
        </div>

        <!-- 工作流程 Tab -->
        <div id="workflow" class="tab-content">
            <div class="architecture-diagram">
                <h2><i class="fas fa-project-diagram"></i> 工作流程詳解</h2>
                
                <h3><i class="fas fa-play"></i> 測試執行流程</h3>
                <div class="flowchart">
                    <div class="flow-step">
                        <h4>1. 初始化階段</h4>
                        <p>載入配置文件 → 建立客戶端 → 設定測試參數</p>
                    </div>
                    <div class="flow-step">
                        <h4>2. 連接階段</h4>
                        <p>獲取登入令牌 → 建立WebSocket連接 → 驗證身份</p>
                    </div>
                    <div class="flow-step">
                        <h4>3. 遊戲階段</h4>
                        <p>載入遊戲配置 → 開始自動遊戲 → 記錄遊戲結果</p>
                    </div>
                    <div class="flow-step">
                        <h4>4. 斷線測試</h4>
                        <p>觸發隨機斷線 → 嘗試重新連接 → 驗證狀態恢復</p>
                    </div>
                    <div class="flow-step">
                        <h4>5. 數據驗證</h4>
                        <p>比對斷線前後數據 → 生成測試報告 → 標記測試結果</p>
                    </div>
                </div>

                <h3><i class="fas fa-network-wired"></i> 重連機制流程</h3>
                <table class="config-table">
                    <thead>
                        <tr>
                            <th>步驟</th>
                            <th>動作</th>
                            <th>預期結果</th>
                            <th>異常處理</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>檢測到網路斷線</td>
                            <td>客戶端進入斷線狀態</td>
                            <td>記錄斷線時間和狀態</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>啟動重連機制</td>
                            <td>嘗試重新建立連接</td>
                            <td>重試次數限制，避免無限重試</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>重新認證登入</td>
                            <td>獲取新的訪問令牌</td>
                            <td>認證失敗則停止重連</td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td>恢復遊戲狀態</td>
                            <td>從伺服器獲取上次狀態</td>
                            <td>狀態不一致則標記錯誤</td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td>繼續遊戲</td>
                            <td>恢復自動遊戲流程</td>
                            <td>監控後續連接穩定性</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 使用說明 Tab -->
        <div id="usage" class="tab-content">
            <div class="architecture-diagram">
                <h2><i class="fas fa-play"></i> 使用說明</h2>
                
                <h3><i class="fas fa-download"></i> 環境準備</h3>
                <div class="code-block">
                    <h4>1. 安裝 Node.js</h4>
                    <pre># 確保 Node.js 版本 8.x 或更高
node --version

# 如果未安裝，請從官網下載：https://nodejs.org/</pre>
                </div>

                <div class="code-block">
                    <h4>2. 安裝依賴套件</h4>
                    <pre># 在專案根目錄執行
npm install .</pre>
                </div>

                <h3><i class="fas fa-rocket"></i> 啟動測試</h3>
                <div class="code-block">
                    <h4>基本啟動命令</h4>
                    <pre># 啟動測試程序
node slot-robot.js

# 系統會提示選擇測試模式：
# - 輸入數字：選擇特定遊戲
# - 直接按 Enter：循序測試所有遊戲
# - 選擇恢復模式：[A]uto 或 [P]manual</pre>
                </div>

                <h3><i class="fas fa-keyboard"></i> 互動式指令</h3>
                <table class="config-table">
                    <thead>
                        <tr>
                            <th>按鍵</th>
                            <th>功能</th>
                            <th>說明</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><kbd>P</kbd></td>
                            <td>手動恢復</td>
                            <td>恢復所有暫停的客戶端</td>
                        </tr>
                        <tr>
                            <td><kbd>A</kbd></td>
                            <td>自動恢復</td>
                            <td>啟動自動恢復循環</td>
                        </tr>
                        <tr>
                            <td><kbd>S</kbd></td>
                            <td>停止自動恢復</td>
                            <td>停止自動恢復循環</td>
                        </tr>
                        <tr>
                            <td><kbd>Ctrl+C</kbd></td>
                            <td>結束程序</td>
                            <td>中斷並結束測試</td>
                        </tr>
                    </tbody>
                </table>

                <h3><i class="fas fa-chart-bar"></i> 數據驗證</h3>
                <div class="code-block">
                    <h4>檢查測試結果</h4>
                    <pre># 檢查所有遊戲記錄
node checkConnectionData.js all

# 檢查特定遊戲記錄
node checkConnectionData.js gameLog_PSS-ON-00001.json

# 查看比較結果
cat comparison_gameLog_PSS-ON-00001.json</pre>
                </div>

                <div class="alert alert-success">
                    <i class="fas fa-check-circle"></i>
                    <strong>測試成功指標：</strong> 
                    <ul>
                        <li>所有斷線重連後數據一致 (areEqual: true)</li>
                        <li>無錯誤日誌或異常中斷</li>
                        <li>達到預設的斷線測試次數</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- 監控面板 Tab -->
        <div id="monitoring" class="tab-content">
            <div class="architecture-diagram">
                <h2><i class="fas fa-chart-line"></i> 即時監控面板</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="activeClients">0</div>
                        <div class="stat-label">活躍客戶端</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalSpins">0</div>
                        <div class="stat-label">總旋轉次數</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="disconnects">0</div>
                        <div class="stat-label">斷線次數</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="successRate">0%</div>
                        <div class="stat-label">重連成功率</div>
                    </div>
                </div>

                <h3><i class="fas fa-list"></i> 客戶端狀態</h3>
                <table class="config-table" id="clientStatus">
                    <thead>
                        <tr>
                            <th>客戶端ID</th>
                            <th>遊戲ID</th>
                            <th>狀態</th>
                            <th>連接時間</th>
                            <th>旋轉次數</th>
                            <th>最後活動</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>robot001</td>
                            <td>PSS-ON-00001</td>
                            <td><span class="status-indicator status-connected"></span>已連接</td>
                            <td>00:05:23</td>
                            <td>142</td>
                            <td>2 秒前</td>
                        </tr>
                    </tbody>
                </table>

                <h3><i class="fas fa-exclamation-triangle"></i> 系統警告</h3>
                <div id="systemAlerts">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i>
                        系統運行正常，所有客戶端狀態良好。
                    </div>
                </div>

                <div class="interactive-demo">
                    <h3><i class="fas fa-play"></i> 模擬控制面板</h3>
                    <button class="demo-button" onclick="simulateConnect()">
                        <i class="fas fa-plug"></i> 模擬連接
                    </button>
                    <button class="demo-button" onclick="simulateDisconnect()">
                        <i class="fas fa-unlink"></i> 模擬斷線
                    </button>
                    <button class="demo-button" onclick="simulateSpin()">
                        <i class="fas fa-sync"></i> 模擬旋轉
                    </button>
                    <button class="demo-button" onclick="clearLog()">
                        <i class="fas fa-trash"></i> 清除日誌
                    </button>
                    
                    <div class="demo-output" id="demoOutput">
                        等待操作指令...
                    </div>
                </div>
            </div>
        </div>

        <!-- 故障排除 Tab -->
        <div id="troubleshooting" class="tab-content">
            <div class="architecture-diagram">
                <h2><i class="fas fa-wrench"></i> 故障排除指南</h2>
                
                <h3><i class="fas fa-bug"></i> 常見問題</h3>
                
                <div class="alert alert-warning">
                    <h4><i class="fas fa-exclamation-triangle"></i> 問題 1: 反覆斷線重連，無法進行自動遊戲</h4>
                    <p><strong>症狀：</strong> 客戶端不斷嘗試重連但始終失敗</p>
                    <p><strong>可能原因：</strong></p>
                    <ul>
                        <li>登入憑證錯誤或過期</li>
                        <li>網路連接不穩定</li>
                        <li>伺服器端拒絕連接</li>
                        <li>重連間隔時間過短</li>
                    </ul>
                    <p><strong>解決方案：</strong></p>
                    <ul>
                        <li>檢查 slot-user-list.json 中的帳號密碼</li>
                        <li>確認伺服器地址正確且可訪問</li>
                        <li>增加重連延遲時間 (ReconnectDelayTimeMS)</li>
                        <li>檢查防火牆和網路代理設定</li>
                    </ul>
                </div>

                <div class="alert alert-warning">
                    <h4><i class="fas fa-exclamation-triangle"></i> 問題 2: 登入失敗 (status_code: 1)</h4>
                    <p><strong>症狀：</strong> 收到 "Login failed with status: 1 (kInvalid)" 錯誤</p>
                    <p><strong>解決方案：</strong></p>
                    <ul>
                        <li>驗證測試帳號是否有效</li>
                        <li>確認 host_prefix 設定正確</li>
                        <li>檢查 API 端點是否可訪問</li>
                        <li>確認帳號未被鎖定或暫停</li>
                    </ul>
                </div>

                <div class="alert alert-warning">
                    <h4><i class="fas fa-exclamation-triangle"></i> 問題 3: 數據不一致</h4>
                    <p><strong>症狀：</strong> checkConnectionData.js 顯示 areEqual: false</p>
                    <p><strong>解決方案：</strong></p>
                    <ul>
                        <li>檢查伺服器端狀態恢復機制</li>
                        <li>驗證遊戲邏輯的正確性</li>
                        <li>檢查網路傳輸過程中的數據損失</li>
                        <li>確認客戶端狀態機工作正常</li>
                    </ul>
                </div>

                <h3><i class="fas fa-tools"></i> 除錯工具</h3>
                <table class="config-table">
                    <thead>
                        <tr>
                            <th>工具</th>
                            <th>用途</th>
                            <th>使用方法</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>日誌檔案</td>
                            <td>查看詳細執行記錄</td>
                            <td>檢查 logs/robot-YYYY-MM-DD.log</td>
                        </tr>
                        <tr>
                            <td>遊戲記錄</td>
                            <td>分析遊戲狀態變化</td>
                            <td>查看 gameLog_*.json 文件</td>
                        </tr>
                        <tr>
                            <td>數據驗證工具</td>
                            <td>檢查數據一致性</td>
                            <td>執行 checkConnectionData.js</td>
                        </tr>
                        <tr>
                            <td>網路監控</td>
                            <td>檢查連接狀態</td>
                            <td>使用瀏覽器開發者工具</td>
                        </tr>
                    </tbody>
                </table>

                <h3><i class="fas fa-code"></i> 除錯程式碼範例</h3>
                <div class="code-block">
                    <pre>// 測試網路連接
const testConnection = async () => {
  try {
    const response = await fetch('https://dev.iplaystar.net/api/signin');
    console.log('API 可訪問:', response.status === 200);
  } catch (error) {
    console.error('網路連接失敗:', error.message);
  }
};

// 檢查WebSocket連接
const testWebSocket = () => {
  const ws = new WebSocket('wss://dev-gs.iplaystar.net:83/slot');
  ws.onopen = () => console.log('WebSocket 連接成功');
  ws.onerror = (error) => console.error('WebSocket 錯誤:', error);
  ws.onclose = () => console.log('WebSocket 連接關閉');
};</pre>
                </div>

                <div class="alert alert-info">
                    <i class="fas fa-lightbulb"></i>
                    <strong>提示：</strong> 如果問題持續存在，請收集完整的日誌檔案並聯絡技術支援團隊。
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Tab 切換功能
        function showTab(tabName) {
            // 隱藏所有 tab 內容
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // 移除所有 nav-tab 的 active 類
            const navTabs = document.querySelectorAll('.nav-tab');
            navTabs.forEach(tab => tab.classList.remove('active'));
            
            // 顯示選中的 tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // 模擬監控功能
        let simulationData = {
            activeClients: 1,
            totalSpins: 142,
            disconnects: 3,
            successRate: 95.7
        };

        function updateStats() {
            document.getElementById('activeClients').textContent = simulationData.activeClients;
            document.getElementById('totalSpins').textContent = simulationData.totalSpins;
            document.getElementById('disconnects').textContent = simulationData.disconnects;
            document.getElementById('successRate').textContent = simulationData.successRate.toFixed(1) + '%';
        }

        function addToLog(message) {
            const output = document.getElementById('demoOutput');
            const timestamp = new Date().toLocaleTimeString();
            output.innerHTML += `[${timestamp}] ${message}\n`;
            output.scrollTop = output.scrollHeight;
        }

        function simulateConnect() {
            simulationData.activeClients++;
            updateStats();
            addToLog('🔌 客戶端已連接 - robot002');
        }

        function simulateDisconnect() {
            if (simulationData.activeClients > 0) {
                simulationData.activeClients--;
                simulationData.disconnects++;
                updateStats();
                addToLog('⚠️  客戶端已斷線 - 啟動重連機制');
            }
        }

        function simulateSpin() {
            simulationData.totalSpins++;
            updateStats();
            addToLog(`🎰 執行旋轉 #${simulationData.totalSpins} - RNG=[3,15,22,8,24] Win=50`);
        }

        function clearLog() {
            document.getElementById('demoOutput').innerHTML = '日誌已清除，等待新的操作...\n';
        }

        // 初始化統計數據
        updateStats();

        // 模擬即時更新
        setInterval(() => {
            if (Math.random() < 0.3) { // 30% 機率執行旋轉
                simulateSpin();
            }
        }, 3000);

        // 初始化歡迎訊息
        window.addEventListener('load', () => {
            addToLog('🚀 監控系統已啟動');
            addToLog('📊 開始收集即時數據...');
        });
    </script>
</body>
</html>