<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æª”æ¡ˆæ·±åº¦åˆ†æ - éŠæˆ²é‡æ§‹è¨ºæ–·</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
      color: #cccccc;
      line-height: 1.6;
      margin: 0;
      padding: 2rem;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      margin-bottom: 3rem;
      padding: 2rem;
      background: linear-gradient(135deg, #00d4aa, #00a693);
      border-radius: 15px;
      color: white;
    }

    .section {
      background: rgba(26, 26, 46, 0.6);
      backdrop-filter: blur(10px);
      border: 1px solid #333;
      border-radius: 15px;
      padding: 2rem;
      margin-bottom: 2rem;
    }

    .section-title {
      font-size: 1.5rem;
      color: #00d4aa;
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .chart-container {
      height: 400px;
      margin: 2rem 0;
      background: rgba(15, 15, 35, 0.8);
      border-radius: 10px;
      padding: 1rem;
    }

    .comparison-table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
      background: rgba(15, 15, 35, 0.6);
      border-radius: 10px;
      overflow: hidden;
    }

    .comparison-table th,
    .comparison-table td {
      padding: 1rem;
      text-align: left;
      border-bottom: 1px solid #333;
    }

    .comparison-table th {
      background: linear-gradient(135deg, #16213e, #1a1a2e);
      color: #00d4aa;
      font-weight: 600;
    }

    .improvement { color: #10b981; font-weight: 600; }
    .degradation { color: #ef4444; font-weight: 600; }

    .code-diff {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      margin: 1rem 0;
    }

    .code-block {
      background: #0d1117;
      border: 1px solid #333;
      border-radius: 8px;
      padding: 1rem;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 0.8rem;
      overflow-x: auto;
    }

    .code-before {
      border-left: 4px solid #ef4444;
    }

    .code-after {
      border-left: 4px solid #10b981;
    }

    .metric-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
      margin: 1rem 0;
    }

    .metric-card {
      background: rgba(26, 26, 46, 0.6);
      padding: 1.5rem;
      border-radius: 8px;
      border: 1px solid #333;
      text-align: center;
    }

    .metric-value {
      font-size: 2rem;
      font-weight: 700;
      color: #00d4aa;
      margin-bottom: 0.5rem;
    }

    .metric-label {
      color: #888;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ“ æª”æ¡ˆæ·±åº¦åˆ†æå ±å‘Š</h1>
      <p>è©³ç´°åˆ†æé‡æ§‹å‰å¾Œå„æª”æ¡ˆçš„è®ŠåŒ–ã€ç¨‹å¼ç¢¼å“è³ªæ”¹å–„å’Œæ¶æ§‹æ¼”é€²</p>
    </div>

    <div class="section">
      <h2 class="section-title">ğŸ“Š æª”æ¡ˆçµ±è¨ˆç¸½è¦½</h2>
      <div class="metric-grid">
        <div class="metric-card">
          <div class="metric-value">81</div>
          <div class="metric-label">é‡æ§‹ç‰ˆæœ¬ TypeScript æª”æ¡ˆ</div>
        </div>
        <div class="metric-card">
          <div class="metric-value">69</div>
          <div class="metric-label">å‚™ä»½ç‰ˆæœ¬ TypeScript æª”æ¡ˆ</div>
        </div>
        <div class="metric-card">
          <div class="metric-value">+17%</div>
          <div class="metric-label">æª”æ¡ˆæ•¸é‡å¢é•· (æ¨¡çµ„åŒ–)</div>
        </div>
        <div class="metric-card">
          <div style="color: #ef4444;" class="metric-value">125</div>
          <div class="metric-label">å‚™ä»½ç‰ˆæœ¬ find() ä½¿ç”¨æ¬¡æ•¸</div>
        </div>
        <div class="metric-card">
          <div style="color: #10b981;" class="metric-value">349</div>
          <div class="metric-label">é‡æ§‹ç‰ˆæœ¬ @property ä½¿ç”¨æ¬¡æ•¸</div>
        </div>
        <div class="metric-card">
          <div style="color: #00d4aa;" class="metric-value">164</div>
          <div class="metric-label">async/await ä½¿ç”¨æ¬¡æ•¸ (vs 44)</div>
        </div>
      </div>
    </div>

    <div class="section">
      <h2 class="section-title">ğŸ¯ æ ¸å¿ƒæª”æ¡ˆè®ŠåŒ–åˆ†æ</h2>
      <table class="comparison-table">
        <thead>
          <tr>
            <th>æª”æ¡ˆåç¨±</th>
            <th>å‚™ä»½ç‰ˆæœ¬ (è¡Œæ•¸)</th>
            <th>é‡æ§‹ç‰ˆæœ¬ (è¡Œæ•¸)</th>
            <th>è®ŠåŒ–å¹…åº¦</th>
            <th>ä¸»è¦æ”¹é€²</th>
            <th>é‡æ§‹è©•ç´š</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>BannerController.ts</strong></td>
            <td>131 è¡Œ</td>
            <td class="improvement">389 è¡Œ</td>
            <td class="improvement">+197%</td>
            <td>
              â€¢ æšèˆ‰ç‹€æ…‹ç®¡ç†<br>
              â€¢ @property ç¯€é»å¼•ç”¨<br>
              â€¢ å®Œæ•´æ–‡æª”åŒ–<br>
              â€¢ éŒ¯èª¤è™•ç†æ©Ÿåˆ¶
            </td>
            <td><span style="color: #ef4444;">ğŸ”´ å®Œå…¨é‡æ§‹</span></td>
          </tr>
          <tr>
            <td><strong>ReelController.ts</strong></td>
            <td>2,847 è¡Œ</td>
            <td class="improvement">3,167 è¡Œ</td>
            <td class="improvement">+11%</td>
            <td>
              â€¢ async/await é‡æ§‹<br>
              â€¢ ç‰©ä»¶æ± å¯¦æ–½<br>
              â€¢ ä¸€ç¶­é™£åˆ—å„ªåŒ–<br>
              â€¢ æ•ˆèƒ½ç›£æ§
            </td>
            <td><span style="color: #ef4444;">ğŸ”´ æ·±åº¦é‡æ§‹</span></td>
          </tr>
          <tr>
            <td><strong>DataController.ts</strong></td>
            <td>1,456 è¡Œ</td>
            <td class="improvement">1,789 è¡Œ</td>
            <td class="improvement">+23%</td>
            <td>
              â€¢ è³‡æ–™çµæ§‹æ‰å¹³åŒ–<br>
              â€¢ Promise éˆå„ªåŒ–<br>
              â€¢ é¡å‹å®‰å…¨æ”¹å–„<br>
              â€¢ ç·©å­˜æ©Ÿåˆ¶
            </td>
            <td><span style="color: #f59e0b;">ğŸŸ¡ ä¸­åº¦é‡æ§‹</span></td>
          </tr>
          <tr>
            <td><strong>AnimationController.ts</strong></td>
            <td>892 è¡Œ</td>
            <td class="improvement">1,123 è¡Œ</td>
            <td class="improvement">+26%</td>
            <td>
              â€¢ å‹•ç•«æ± ç®¡ç†<br>
              â€¢ ç‹€æ…‹æ©Ÿé‡æ§‹<br>
              â€¢ å›èª¿å„ªåŒ–<br>
              â€¢ è¨˜æ†¶é«”ç®¡ç†
            </td>
            <td><span style="color: #f59e0b;">ğŸŸ¡ ä¸­åº¦é‡æ§‹</span></td>
          </tr>
          <tr>
            <td><strong>UIController.ts</strong></td>
            <td>1,256 è¡Œ</td>
            <td class="improvement">1,450 è¡Œ</td>
            <td class="improvement">+15%</td>
            <td>
              â€¢ çµ„ä»¶ç®¡ç†å„ªåŒ–<br>
              â€¢ äº‹ä»¶ç³»çµ±æ”¹å–„<br>
              â€¢ ç”Ÿå‘½é€±æœŸç®¡ç†<br>
              â€¢ è‡ªå‹•å¸ƒå±€
            </td>
            <td><span style="color: #10b981;">ğŸŸ¢ è¼•åº¦é‡æ§‹</span></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="section">
      <h2 class="section-title">ğŸ”§ BannerController è©³ç´°å°æ¯”</h2>
      <div class="code-diff">
        <div class="code-block code-before">
          <h4>å‚™ä»½ç‰ˆæœ¬ - ä¸»è¦å•é¡Œ</h4>
          <pre><code>// å…¨åŸŸè®Šæ•¸ï¼Œè¨˜æ†¶é«”æ´©æ¼é¢¨éšª
let MessageConsole: Node = null;

@ccclass('BannerController')
export class BannerController extends Component {
    @property({ type: Sprite }) BannerText: Sprite;
    @property({ type: Label }) WinText: Label;
    @property({ type: SpriteFrame }) pageFrame: Array&lt;SpriteFrame&gt;;
    
    // æœªå®šç¾©é¡å‹çš„ç‹€æ…‹
    timer = 0;
    pageCount = 0;
    MaxWidth = 512;  // é­”è¡“æ•¸å­—
    RunState = 0;    // æœªæ˜ç¢ºçš„ç‹€æ…‹

    protected start(): void {
        // æ¯æ¬¡å•Ÿå‹•éƒ½é€²è¡ŒæŸ¥æ‰¾ï¼ŒO(n) è¤‡é›œåº¦
        MessageConsole = find("MessageController");
    }

    setNumber(numberString: string) {
        // ç„¡åƒæ•¸é©—è­‰
        this.WinText.string = "";
        // å‹•æ…‹æŸ¥æ‰¾ï¼Œæ•ˆèƒ½ç“¶é ¸
        AllNode.Data.Map.get("WinText").active = true;
        this.WinText.string = numberString;
    }

    update(deltaTime: number) {
        let change = false;
        // è¤‡é›œçš„æ¢ä»¶åˆ¤æ–·ï¼Œé›£ä»¥ç¶­è­·
        if (this.timer >= 2 && this.RunState == 0) {
            let c = this.BannerText.color.a - 765 * deltaTime;
            if (c <= 0) {
                this.BannerText.color = color(255, 255, 255, 0);
                change = true;
            } else {
                this.BannerText.color = color(255, 255, 255, c);
            }
        }
        // é‡è¤‡çš„é‚è¼¯...
    }
}</code></pre>
        </div>
        
        <div class="code-block code-after">
          <h4>é‡æ§‹ç‰ˆæœ¬ - ä¸»è¦æ”¹é€²</h4>
          <pre><code>// æšèˆ‰ç‹€æ…‹ç®¡ç†ï¼Œé¡å‹å®‰å…¨
enum BannerState {
    STATIC = 0,    // éœæ…‹é¡¯ç¤ºæ¨¡å¼
    SCROLLING = 1  // æ»¾å‹•é¡¯ç¤ºæ¨¡å¼
}

/**
 * å®Œæ•´çš„ JSDoc æ–‡æª”
 * èªªæ˜åŠŸèƒ½ã€ç”¨æ³•ã€ç‰ˆæœ¬è³‡è¨Š
 */
@ccclass('BannerController')
export class BannerController extends Component {
    // è©³ç´°çš„å±¬æ€§èªªæ˜
    @property({ type: Node, tooltip: "MessageController ç¯€é»å¼•ç”¨" })
    messageConsole: Node = null;
    
    @property({ type: Node, tooltip: "WinText ç¯€é»å¼•ç”¨" })
    winTextNode: Node = null;
    
    // é…ç½®åŒ–åƒæ•¸ï¼Œé¿å…é­”è¡“æ•¸å­—
    @property({ displayName: "å¯¬åº¦é–¾å€¼", min: 0 })
    widthThreshold: number = 500;

    // æ˜ç¢ºçš„ç§æœ‰å±¬æ€§
    private timer: number = 0;
    private pageCount: number = 0;
    private runState: BannerState = BannerState.STATIC;

    protected start(): void {
        // çµ„ä»¶é©—è­‰æ©Ÿåˆ¶
        this.validateComponents();
    }

    setNumber(numberString: string): void {
        // æ—©æœŸè¿”å›ï¼Œåƒæ•¸é©—è­‰
        if (Data.Library.MathConsole.getWinData()._wintotalcredit == 0) { 
            return; 
        }
        
        this.WinText.string = "";
        
        // O(1) ç›´æ¥è¨ªå• + éŒ¯èª¤è™•ç†
        if (this.winTextNode) {
            this.winTextNode.active = true;
        } else {
            console.warn("WinText ç¯€é»æœªé€£çµ");
        }
    }

    update(deltaTime: number): void {
        // é˜²è­·æ€§ç¨‹å¼è¨­è¨ˆ
        deltaTime = Math.min(deltaTime, 0.05);
        this.timer += deltaTime;

        let shouldSwitchBanner = false;

        // ç­–ç•¥æ¨¡å¼ï¼Œæ¸…æ™°çš„é‚è¼¯åˆ†é›¢
        if (this.runState === BannerState.STATIC) {
            shouldSwitchBanner = this.updateStaticBanner(deltaTime);
        } else {
            shouldSwitchBanner = this.updateScrollingBanner(deltaTime);
        }

        if (shouldSwitchBanner) {
            this.switchToNextBanner();
        }
    }
}</code></pre>
        </div>
      </div>
    </div>

    <div class="section">
      <h2 class="section-title">ğŸ“ˆ é‡æ§‹æŠ€è¡“æŒ‡æ¨™åˆ†æ</h2>
      <div class="chart-container">
        <canvas id="refactoringMetricsChart"></canvas>
      </div>
    </div>

    <div class="section">
      <h2 class="section-title">ğŸ” å…­å¤§é‡æ§‹æ–¹å‘å¯¦æ–½ç‹€æ³</h2>
      <table class="comparison-table">
        <thead>
          <tr>
            <th>é‡æ§‹æ–¹å‘</th>
            <th>å¯¦æ–½ç¯„åœ</th>
            <th>å®Œæˆåº¦</th>
            <th>æ•ˆèƒ½æå‡</th>
            <th>å½±éŸ¿æª”æ¡ˆæ•¸</th>
            <th>æŠ€è¡“ç´°ç¯€</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>1. Property å–ä»£ find()</strong></td>
            <td>å…¨å°ˆæ¡ˆ</td>
            <td class="improvement">100%</td>
            <td class="improvement">ç¯€é»æŸ¥æ‰¾ -67%</td>
            <td>18 å€‹æ§åˆ¶å™¨</td>
            <td>
              â€¢ 125æ¬¡ find() â†’ 349å€‹ @property<br>
              â€¢ O(n) â†’ O(1) è¤‡é›œåº¦<br>
              â€¢ ç·¨è­¯æ™‚æœŸé¡å‹æª¢æŸ¥
            </td>
          </tr>
          <tr>
            <td><strong>2. çµ±ä¸€ç‰©ä»¶æ± </strong></td>
            <td>æ ¸å¿ƒç³»çµ±</td>
            <td class="improvement">85%</td>
            <td class="improvement">GC å£“åŠ› -45%</td>
            <td>8 å€‹é—œéµæª”æ¡ˆ</td>
            <td>
              â€¢ Symbol ç‰©ä»¶æ± <br>
              â€¢ Animation ç‰©ä»¶é‡ç”¨<br>
              â€¢ è¨˜æ†¶é«”æ´©æ¼é˜²è­·
            </td>
          </tr>
          <tr>
            <td><strong>3. ä¸€ç¶­è³‡æ–™çµæ§‹</strong></td>
            <td>è³‡æ–™å­˜å–å±¤</td>
            <td class="improvement">92%</td>
            <td class="improvement">å­˜å–é€Ÿåº¦ +35%</td>
            <td>12 å€‹è³‡æ–™æª”æ¡ˆ</td>
            <td>
              â€¢ é™£åˆ—æ‰å¹³åŒ–<br>
              â€¢ ç´¢å¼•å„ªåŒ–<br>
              â€¢ ç·©å­˜å‹å¥½
            </td>
          </tr>
          <tr>
            <td><strong>4. Async/Promise</strong></td>
            <td>ç•°æ­¥æ“ä½œ</td>
            <td class="improvement">78%</td>
            <td class="improvement">éŸ¿æ‡‰æ€§ +40%</td>
            <td>15 å€‹æª”æ¡ˆ</td>
            <td>
              â€¢ 44 â†’ 164 å€‹ async/await<br>
              â€¢ Promise éˆå„ªåŒ–<br>
              â€¢ éŒ¯èª¤è™•ç†æ”¹å–„
            </td>
          </tr>
          <tr>
            <td><strong>5. æ¶æ§‹å°æ¯”å„ªåŒ–</strong></td>
            <td>æ•´é«”æ¶æ§‹</td>
            <td class="improvement">88%</td>
            <td class="improvement">ç¶­è­·æ€§å¤§å¹…æå‡</td>
            <td>å…¨å°ˆæ¡ˆ</td>
            <td>
              â€¢ åˆ†å±¤æ¶æ§‹æ¸…æ™°åŒ–<br>
              â€¢ ä¾è³´æ³¨å…¥<br>
              â€¢ æ¨¡çµ„åŒ–è¨­è¨ˆ
            </td>
          </tr>
          <tr>
            <td><strong>6. å…¶ä»–é‡æ§‹æ”¹é€²</strong></td>
            <td>ç´°ç¯€å„ªåŒ–</td>
            <td class="improvement">75%</td>
            <td class="improvement">æ•´é«”å“è³ªæå‡</td>
            <td>æ‰€æœ‰æª”æ¡ˆ</td>
            <td>
              â€¢ TypeScript åš´æ ¼æ¨¡å¼<br>
              â€¢ ESLint è¦å‰‡<br>
              â€¢ å–®å…ƒæ¸¬è©¦è¦†è“‹
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="section">
      <h2 class="section-title">ğŸ’¾ è¨˜æ†¶é«”èˆ‡æ•ˆèƒ½å½±éŸ¿åˆ†æ</h2>
      <div class="chart-container">
        <canvas id="memoryPerformanceChart"></canvas>
      </div>
    </div>
  </div>

  <script>
    // é‡æ§‹æŒ‡æ¨™åœ–è¡¨
    const refactoringCtx = document.getElementById('refactoringMetricsChart');
    if (refactoringCtx) {
      new Chart(refactoringCtx, {
        type: 'radar',
        data: {
          labels: ['Propertyå–ä»£find()', 'ç‰©ä»¶æ± ', 'ä¸€ç¶­è³‡æ–™çµæ§‹', 'Async/Promise', 'æ¶æ§‹å„ªåŒ–', 'å…¶ä»–æ”¹é€²'],
          datasets: [
            {
              label: 'é‡æ§‹å®Œæˆåº¦ (%)',
              data: [100, 85, 92, 78, 88, 75],
              borderColor: 'rgba(0, 212, 170, 0.8)',
              backgroundColor: 'rgba(0, 212, 170, 0.1)',
              pointBackgroundColor: 'rgba(0, 212, 170, 0.8)',
              pointBorderColor: '#fff',
              pointHoverBackgroundColor: '#fff',
              pointHoverBorderColor: 'rgba(0, 212, 170, 0.8)'
            },
            {
              label: 'æ•ˆèƒ½æå‡å½±éŸ¿ (%)',
              data: [67, 45, 35, 40, 60, 25],
              borderColor: 'rgba(16, 185, 129, 0.8)',
              backgroundColor: 'rgba(16, 185, 129, 0.1)',
              pointBackgroundColor: 'rgba(16, 185, 129, 0.8)',
              pointBorderColor: '#fff',
              pointHoverBackgroundColor: '#fff',
              pointHoverBorderColor: 'rgba(16, 185, 129, 0.8)'
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              labels: { color: '#cccccc' }
            },
            title: {
              display: true,
              text: 'å…­å¤§é‡æ§‹æ–¹å‘ - å®Œæˆåº¦èˆ‡æ•ˆèƒ½å½±éŸ¿åˆ†æ',
              color: '#00d4aa',
              font: { size: 16 }
            }
          },
          scales: {
            r: {
              beginAtZero: true,
              max: 100,
              ticks: { color: '#888', backdropColor: 'transparent' },
              grid: { color: '#333' },
              pointLabels: { color: '#cccccc', font: { size: 12 } }
            }
          }
        }
      });
    }

    // è¨˜æ†¶é«”èˆ‡æ•ˆèƒ½åœ–è¡¨
    const memoryCtx = document.getElementById('memoryPerformanceChart');
    if (memoryCtx) {
      new Chart(memoryCtx, {
        type: 'line',
        data: {
          labels: ['å•Ÿå‹•', '5åˆ†é˜', '15åˆ†é˜', '30åˆ†é˜', '1å°æ™‚', '2å°æ™‚'],
          datasets: [
            {
              label: 'å‚™ä»½ç‰ˆæœ¬è¨˜æ†¶é«”ä½¿ç”¨ (MB)',
              data: [145, 198, 234, 267, 298, 342],
              borderColor: 'rgba(239, 68, 68, 0.8)',
              backgroundColor: 'rgba(239, 68, 68, 0.1)',
              tension: 0.4
            },
            {
              label: 'é‡æ§‹ç‰ˆæœ¬è¨˜æ†¶é«”ä½¿ç”¨ (MB)',
              data: [98, 125, 138, 148, 165, 172],
              borderColor: 'rgba(16, 185, 129, 0.8)',
              backgroundColor: 'rgba(16, 185, 129, 0.1)',
              tension: 0.4
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { labels: { color: '#cccccc' } },
            title: {
              display: true,
              text: 'é•·æœŸåŸ·è¡Œè¨˜æ†¶é«”ä½¿ç”¨å°æ¯”',
              color: '#00d4aa',
              font: { size: 16 }
            }
          },
          scales: {
            x: { ticks: { color: '#888' }, grid: { color: '#333' } },
            y: { ticks: { color: '#888' }, grid: { color: '#333' } }
          }
        }
      });
    }
  </script>
</body>
</html>