<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Slot Game å‹•æ…‹è³‡ç”¢ç”Ÿæˆ Pipeline (Refactored v2)</title>
  <meta name="description" content="Slot å‹•æ…‹ç‰¹æ•ˆé æ¸²æŸ“ / Spine / ç¨‹åºåŒ– / Hybrid ä¸€é«”åŒ–è£½ç¨‹èˆ‡è‡ªå‹•åŒ–æ²»ç†" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      color-scheme: light dark;
      --bg: #0d121b;
      --panel: #121c2b;
      --panel-alt: #182538;
      --panel-soft: rgba(255,255,255,0.05);
      --text: #eef4ff;
      --text-dim: #a9b8cc;
      --primary: #5ed1ff;
      --primary-glow: 0 0 0 4px rgba(94,209,255,0.15);
      --accent: #ffcc5c;
      --danger: #f87171;
      --warn: #fbbf24;
      --ok: #34d399;
      --border: rgba(255,255,255,0.12);
      --gradient: radial-gradient(circle at 18% 18%,rgba(94,209,255,0.18),transparent 60%),radial-gradient(circle at 82% 12%,rgba(255,204,92,0.18),transparent 55%),linear-gradient(140deg,#0d121b,#0b1624 55%,#09101a);
      --code: #d9f6ff;
      --mono: 'JetBrains Mono','Fira Code',monospace;
      --shadow-elev: 0 8px 28px -6px rgba(0,0,0,0.5),0 0 0 1px rgba(255,255,255,0.04);
      --radius-s: 6px; --radius-m: 14px; --radius-l: 22px;
      --trans-fast: 140ms cubic-bezier(.4,.2,.2,1);
    }
    * { box-sizing: border-box; }
    body { margin:0; font-family:'Inter','Noto Sans TC',system-ui,sans-serif; background:var(--gradient); color:var(--text); line-height:1.6; }
    h1,h2,h3,h4 { font-weight:600; line-height:1.25; }
    h2 { scroll-margin-top: 88px; }
    p { margin: 0 0 14px; }
    a { color: var(--primary); text-decoration:none; }
    a:hover { text-decoration:underline; }

    /* Layout */
    .layout { display:grid; grid-template-columns: 270px 1fr; max-width: 1750px; margin:0 auto; gap:24px; padding:0 24px 120px; }
    @media (max-width:1240px){ .layout { grid-template-columns: 240px 1fr; } }
    @media (max-width:980px){ .layout { grid-template-columns:1fr; padding:0 18px 120px;} nav.sidebar {position:static; height:auto; max-height:none;} }

    header.hero { padding:56px 8vw 32px; position:relative; }
    header.hero:before { content:""; position:absolute; inset:0; background: radial-gradient(circle at 40% 0%,rgba(94,209,255,0.28),transparent 55%); pointer-events:none; }
    .hero-inner { position:relative; display:flex; flex-direction:column; gap:32px; }
    .hero-grid { display:grid; gap:16px; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); }
    .metric { background:var(--panel); border:1px solid var(--border); border-radius:var(--radius-m); padding:14px 16px; display:grid; gap:4px; box-shadow:var(--shadow-elev); }
    .metric span.label { font-size:11px; letter-spacing:0.08em; text-transform:uppercase; color:var(--text-dim); }
    .metric strong { font-size:15px; font-weight:600; }

    nav.sidebar { position:sticky; top:12px; align-self:start; display:flex; flex-direction:column; gap:18px; height: calc(100vh - 24px); overflow:auto; padding:20px 18px 40px; background:linear-gradient(145deg,#111b29,#0f1925); border:1px solid var(--border); border-radius:var(--radius-l); box-shadow:0 10px 50px -10px rgba(0,0,0,0.6); }
    .nav-group { display:grid; gap:4px; }
    .nav-title { font-size:11px; font-weight:600; letter-spacing:0.09em; text-transform:uppercase; margin:12px 0 4px; color:var(--text-dim); }
    .sidebar a { font-size:13px; padding:6px 10px 6px 12px; border-radius:10px; color:var(--text-dim); display:flex; gap:6px; align-items:center; transition:var(--trans-fast); position:relative; }
    .sidebar a.active, .sidebar a:hover { color:var(--text); background:var(--panel-soft); }
    .badge-inline { background:var(--panel-soft); padding:2px 8px 3px; border-radius:999px; font-size:11px; letter-spacing:0.02em; color:var(--primary); border:1px solid rgba(255,255,255,0.08); }

    main { display:grid; gap:48px; }
    section.panel { background:var(--panel-alt); padding:34px 38px 42px; border:1px solid var(--border); border-radius:var(--radius-l); box-shadow:var(--shadow-elev); position:relative; overflow:hidden; }
    section.panel:before { content:""; position:absolute; inset:0; background:radial-gradient(circle at 85% 15%,rgba(94,209,255,0.12),transparent 60%); pointer-events:none; }
    section.panel h2 { margin:0 0 18px; font-size:1.8rem; }
    section.panel h3 { margin:30px 0 12px; font-size:1.18rem; color:var(--primary); letter-spacing:0.01em; }

    .grid { display:grid; gap:16px; }
    .grid.cols-3 { grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); }
    .callout { border-left:4px solid var(--accent); background:rgba(255,204,92,0.08); padding:14px 18px; border-radius:12px; font-size:0.95rem; margin:18px 0; }
    .info { border-left:4px solid var(--primary); background:rgba(94,209,255,0.08); padding:14px 18px; border-radius:12px; margin:18px 0; }
    .warn { border-left:4px solid var(--warn); background:rgba(251,191,36,0.1); padding:14px 18px; border-radius:12px; margin:18px 0; }

    /* Tables */
    .table-wrap { overflow:auto; border:1px solid var(--border); border-radius:16px; margin:18px 0; }
    table { width:100%; border-collapse:collapse; font-size:14px; background:#101a27; min-width:640px; }
    th,td { padding:10px 14px; border-bottom:1px solid rgba(255,255,255,0.07); vertical-align:top; }
    th { text-align:left; font-weight:600; color:var(--primary); font-size:13px; letter-spacing:0.03em; white-space:nowrap; }
    tbody tr:last-child td { border-bottom:none; }
    tbody tr.highlight { background:linear-gradient(90deg,rgba(94,209,255,0.12),transparent); }

    /* Cards */
    .card { background:var(--panel); border:1px solid var(--border); border-radius:18px; padding:18px 20px 20px; display:grid; gap:10px; position:relative; }
    .card h4 { margin:0; font-size:16px; }
    .tag-row { display:flex; flex-wrap:wrap; gap:8px; }
    .tag { font-size:11px; background:rgba(255,255,255,0.08); padding:4px 10px 5px; border-radius:999px; letter-spacing:0.03em; color:var(--text-dim); cursor:default; }
    .tag[data-variant="type"] { background:rgba(94,209,255,0.15); color:var(--primary); border:1px solid rgba(94,209,255,0.3); }

    /* Code */
    pre.code { background:#0f1924; border:1px solid var(--border); border-radius:16px; padding:18px 20px; font-family:var(--mono); font-size:13px; line-height:1.55; overflow:auto; color:var(--code); position:relative; }
    pre.code:before { content:"CODE"; position:absolute; top:6px; right:12px; font-size:10px; letter-spacing:0.12em; opacity:0.4; }

    details.slim { background:var(--panel); border:1px solid var(--border); border-radius:14px; padding:10px 14px; }
    details.slim summary { cursor:pointer; list-style:none; font-weight:600; color:var(--primary); }
    details.slim[open] { box-shadow:var(--shadow-elev); }

    .flow-diagram { display:grid; gap:12px; margin:18px 0; }
    .flow-row { display:flex; flex-wrap:wrap; gap:10px; align-items:stretch; }
    .flow-node { flex:1 1 180px; min-width:160px; background:var(--panel); border:1px solid var(--border); border-radius:14px; padding:12px 14px; font-size:13px; position:relative; display:grid; gap:6px; }
    .flow-node:after { content:""; position:absolute; width:34px; height:2px; background:linear-gradient(90deg,var(--primary),transparent); right:-34px; top:50%; transform:translateY(-50%); opacity:0.6; }
    .flow-row .flow-node:last-child:after { display:none; }
    .flow-node strong { font-size:13px; }
    .flow-node span.small { font-size:11px; color:var(--text-dim); }

    /* Decision Helper */
    .helper { display:grid; gap:16px; background:var(--panel); border:1px solid var(--border); border-radius:18px; padding:20px 22px 24px; }
    .helper-grid { display:grid; gap:14px; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); }
    .helper label { display:grid; gap:6px; font-size:12px; letter-spacing:0.05em; text-transform:uppercase; color:var(--text-dim); }
    .helper select,.helper input { background:#0f1924; color:var(--text); border:1px solid var(--border); border-radius:10px; padding:8px 10px; font-size:14px; }
    .helper button { background:linear-gradient(135deg,#1796c8,#43c7ff); color:#fff; font-weight:600; border:none; padding:12px 16px; border-radius:12px; cursor:pointer; font-size:14px; letter-spacing:0.02em; box-shadow:0 4px 18px -4px rgba(12,182,255,0.5); transition:var(--trans-fast); }
    .helper button:hover { filter:brightness(1.08); box-shadow:0 6px 24px -4px rgba(12,182,255,0.6); }
    .helper-output { background:#0f1924; border:1px solid var(--border); border-radius:14px; padding:16px 18px; font-size:14px; display:grid; gap:10px; }
    .helper-output .result-main { font-size:16px; font-weight:600; }
    .result-main span { padding:4px 10px 5px; border-radius:999px; font-size:12px; letter-spacing:0.05em; background:rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.15); }

    .filters { display:flex; flex-wrap:wrap; gap:8px; margin:6px 0 14px; }
    .filters button { background:rgba(255,255,255,0.08); border:1px solid var(--border); color:var(--text-dim); padding:6px 10px; border-radius:10px; font-size:12px; cursor:pointer; letter-spacing:0.04em; }
    .filters button.active { background:var(--primary); color:#08212d; font-weight:600; box-shadow:var(--primary-glow); }

    footer { max-width:1750px; margin:64px auto 0; padding:32px 24px 72px; text-align:center; font-size:12px; color:var(--text-dim); }
    .divider { height:1px; background:linear-gradient(90deg,transparent,rgba(255,255,255,0.18),transparent); margin:32px 0; }
  </style>
</head>
<body>
  <header class="hero">
    <div class="hero-inner">
      <div>
        <h1>ğŸŒ€ Slot Game å‹•æ…‹è³‡ç”¢ç”Ÿæˆç®¡ç·š (Refactored v2)</h1>
        <p style="max-width:880px;color:var(--text-dim);">æ•´åˆ <strong>é æ¸²æŸ“ (Video/SpriteSheet)</strong>ã€<strong>Spine éª¨æ¶</strong>ã€<strong>ç¨‹åºåŒ– Runtime (Tween/Shader/DSL)</strong> èˆ‡ <strong>Hybrid</strong> çš„çµ±ä¸€æ±ºç­–èˆ‡ç”Ÿç”¢æ¨™æº–ï¼Œæ”¯æ´è¦æ ¼ â†’ ç”Ÿæˆ â†’ QA â†’ ç‰ˆæœ¬æ²»ç† â†’ æ•ˆèƒ½åº¦é‡ã€‚</p>
      </div>
      <div class="hero-grid">
        <div class="metric"><span class="label">ç‰ˆæœ¬</span><strong>v2.0 (Refactor)</strong></div>
        <div class="metric"><span class="label">æ›´æ–°æ—¥æœŸ</span><strong>2025-10-03</strong></div>
        <div class="metric"><span class="label">æ ¸å¿ƒå¼•æ“</span><strong>Gemini 2.5 ãƒ» Veo 3</strong></div>
        <div class="metric"><span class="label">è¦†è“‹é¡å‹</span><strong>9 å‹•æ…‹åˆ†é¡</strong></div>
        <div class="metric"><span class="label">äº¤ä»˜æ¨¡å¼</span><strong>4 (V / S / R / H)</strong></div>
        <div class="metric"><span class="label">è‡ªå‹• QA æŒ‡æ¨™</span><strong>12+</strong></div>
      </div>
      <div class="callout"><strong>å°è®€ï¼š</strong> å…ˆçœ‹ã€ŒA. å¿«é€Ÿä¸Šç·šã€ã€å†ç”¨ã€ŒB. æ±ºç­–èˆ‡åˆ†é¡ã€åˆ¤æ–·ç”¢å‡ºæ¨¡å¼ï¼Œä¹‹å¾Œä¾å°æ‡‰ç®¡ç·šç« ç¯€è½åœ°ï¼Œæœ€å¾Œç”¨ QA / Manifest / è‡ªå‹•åŒ–å·¥å…·æ”¶æ–‚ã€‚</div>
    </div>
  </header>

  <div class="layout">
    <nav class="sidebar" id="sidebar">
      <div class="nav-group">
        <div class="nav-title">Overview</div>
        <a href="#quickstart">A. å¿«é€Ÿä¸Šç·š</a>
        <a href="#decision">B. æ±ºç­–èˆ‡åˆ†é¡</a>
        <a href="#flows">C. å››å¤§ç®¡ç·šæµç¨‹</a>
        <a href="#specs">D. è¦æ ¼ & Artifact</a>
        <a href="#prompts">E. Prompt Library</a>
        <a href="#automation">F. è‡ªå‹•åŒ– / CLI</a>
        <a href="#quality">G. å“è³ª & æ•ˆèƒ½</a>
        <a href="#risk">H. é¢¨éšª & ç‰ˆæœ¬</a>
        <a href="#appendix">é™„éŒ„ (Reference)</a>
      </div>
    </nav>

    <main>
      <!-- A. å¿«é€Ÿä¸Šç·š -->
      <section id="quickstart" class="panel">
        <h2>A. å¿«é€Ÿä¸Šç·š (5-Step Launch)</h2>
        <div class="grid cols-3">
          <div class="card"><h4>1. å»ºç«‹ Catalog</h4><p>åˆ—å‡ºæ ¸å¿ƒ 10 å€‹å‹•æ…‹ï¼Œå¡«å…¥ <code>effects_catalog.yaml</code> åŸºç¤æ¬„ä½ï¼š<code>id, category, durationSec, perfBudgetKB</code>ã€‚</p></div>
          <div class="card"><h4>2. é¸æ“‡äº¤ä»˜æ¨¡å¼</h4><p>ç”¨ä¸‹æ–¹ã€Œæ±ºç­–åŠ©æ‰‹ã€è¼¸å…¥è¦–è¦ºè¤‡é›œåº¦ / å¾ªç’° / é«”ç©é ç®— â†’ å¾—å‡º <code>deliveryType</code>ã€‚</p></div>
          <div class="card"><h4>3. Prompt ç”Ÿæˆ</h4><p>å¼•ç”¨å°æ‡‰æ¨¡æ¿ï¼ˆE ç¯€ï¼‰ï¼ŒGemini è‡ªå‹•è£œèªæ„çŸ©é™£ + å¦å®šè©ã€‚</p></div>
          <div class="card"><h4>4. è‡ªå‹•åˆç¯© + å¾Œè™•ç†</h4><p>åŸ·è¡Œ <code>veo_generate â†’ evaluate_clip â†’ extract_frames â†’ build_spritesheet</code> æˆ– DSL è§£æã€‚</p></div>
          <div class="card"><h4>5. Manifest + QA</h4><p>å¯«å…¥ <code>memoryCost / fps / duration / hash</code>ï¼Œå¥— QA è¦å‰‡ï¼ˆG ç¯€ï¼‰â†’ é€šéå³ç´å…¥ç‰ˆæœ¬ã€‚</p></div>
          <div class="card"><h4>é‡Œç¨‹ç¢‘ KPI</h4><p>é¦–æ‰¹å¹³å‡è¿­ä»£ â‰¤ 3 æ¬¡ï¼›QA é€šéç‡ â‰¥ 80%ï¼›å¹³å‡é«”ç© â‰¤ é ç®— +10%ã€‚</p></div>
        </div>
      </section>

      <!-- B. æ±ºç­–èˆ‡åˆ†é¡ -->
      <section id="decision" class="panel">
        <h2>B. å‹•æ…‹åˆ†é¡èˆ‡äº¤ä»˜æ±ºç­–</h2>
        <p>å°‡ç”¢å‡ºæ–¹æ³•çµ±ä¸€ç‚ºå››è±¡é™ï¼š<strong>V = Video/åºåˆ—</strong>ã€<strong>S = Spine</strong>ã€<strong>R = Runtime ç¨‹åº</strong>ã€<strong>H = Hybrid çµ„åˆ</strong>ã€‚ä¸‹è¡¨å¯ä¾ç¯©é¸å¿«é€Ÿå°æ‡‰ã€‚</p>
        <div class="filters" id="typeFilters">
          <button data-filter="video">Video</button>
          <button data-filter="spine">Spine</button>
          <button data-filter="runtime">Runtime</button>
          <button data-filter="hybrid">Hybrid</button>
          <button data-filter="reset" class="active">å…¨éƒ¨</button>
        </div>
        <div class="table-wrap"><table id="decisionTable">
          <thead><tr><th>åˆ†é¡</th><th>ç›®çš„</th><th>å…¸å‹æ™‚é•·</th><th>å»ºè­°äº¤ä»˜æ¨¡å¼</th><th>å‚™è¨»</th></tr></thead>
          <tbody>
            <tr data-type="video"><td>ç¬¦è™Ÿå‘½ä¸­</td><td>å¼·èª¿å–®ä¸€è´åœ–</td><td>0.6â€“0.9s</td><td>V / H</td><td>å½±ç‰‡ + ç¨‹åºæƒå…‰</td></tr>
            <tr data-type="runtime"><td>ç¬¦è™Ÿ Idle</td><td>å¾®å¾ªç’°</td><td>0.8â€“1.2s Loop</td><td>R / S</td><td>ç¨‹å¼ç¸®æ”¾ / Tint / Spine è¼•éª¨æ¶</td></tr>
            <tr data-type="video hybrid"><td>Line Win</td><td>è·¯å¾‘æƒæ</td><td>0.8â€“1.2s</td><td>R â†’ (V/H) è‹¥ç²’å­è¤‡é›œ</td><td>å„ªå…ˆç¨‹åºä»¥ç¯€çœé«”ç©</td></tr>
            <tr data-type="video"><td>è½ç‰Œæ•ˆæœ</td><td>æœŸå¾…ç‡Ÿé€ </td><td>1.0â€“1.4s</td><td>V / H</td><td>å«å…‰æšˆæ¼‚ç§»</td></tr>
            <tr data-type="video"><td>èƒŒæ™¯å¾ªç’°</td><td>æ°›åœ</td><td>4â€“8s Loop</td><td>V</td><td>åš´æ§ loopSeam</td></tr>
            <tr data-type="video hybrid"><td>Free Spin è½‰å ´</td><td>æ¨¡å¼åˆ‡æ›</td><td>1.5â€“2.5s</td><td>V / H</td><td>å¤šåˆ†å±¤ç‰¹æ•ˆ</td></tr>
            <tr data-type="video hybrid"><td>Big / Mega Win</td><td>æƒ…ç·’å³°å€¼</td><td>2.0â€“3.0s</td><td>H</td><td>å½±ç‰‡ + ç¨‹åºæ•¸å­—/æƒå…‰</td></tr>
            <tr data-type="video runtime"><td>çµç®—ç•«é¢</td><td>åˆ†æ•¸å›é¥‹</td><td>1.2â€“2.0s</td><td>V + R</td><td>æ•¸å­—è·³å‹•ç¨‹å¼åŒ–</td></tr>
          </tbody>
        </table></div>

        <h3>æ±ºç­–åŠ©æ‰‹ (Delivery Type Helper)</h3>
        <div class="helper" id="helper">
          <div class="helper-grid">
            <label>è¦–è¦ºè¤‡é›œåº¦
              <select id="complexity"><option value="low">Low</option><option value="medium">Medium</option><option value="high">High</option></select>
            </label>
            <label>å¾ªç’°éœ€æ±‚ (Loop)
              <select id="loop"><option value="none">None</option><option value="short">Short (â‰¤2s)</option><option value="long">Long (&gt;2s)</option></select>
            </label>
            <label>é«”ç©é ç®— (KB)
              <input type="number" id="budget" value="500" min="50" />
            </label>
            <label>äº’å‹• / åƒæ•¸åŒ–
              <select id="interactive"><option value="low">Low</option><option value="medium">Medium</option><option value="high">High</option></select>
            </label>
            <label>æ’­æ”¾é »ç‡
              <select id="freq"><option value="rare">Rare</option><option value="moderate">Moderate</option><option value="high">High</option></select>
            </label>
            <label>å³°å€¼è¦–è¦ºè¦æ±‚
              <select id="peak"><option value="low">Low</option><option value="medium">Medium</option><option value="high">High</option></select>
            </label>
          </div>
          <button id="runDecision">åˆ†æäº¤ä»˜æ¨¡å¼</button>
          <div class="helper-output" id="decisionOutput" hidden>
            <div class="result-main">å»ºè­°æ¨¡å¼ï¼š<span id="resultType"></span></div>
            <div id="resultReason" style="color:var(--text-dim);"></div>
            <div id="resultNext"></div>
          </div>
        </div>

        <h3>æ±ºç­–è¦å‰‡ï¼ˆæ‘˜è¦ï¼‰</h3>
        <ul>
          <li>Complexity = high ä¸” Peak = high â†’ Video / Hybrid å„ªå…ˆã€‚</li>
          <li>Loop = long ä¸” Budget &lt; 300KB â†’ Spine æˆ– Runtimeã€‚</li>
          <li>Interactive = high â†’ Runtime / Spineï¼›è‹¥ä»éœ€é«˜å…‰å½± â†’ Hybridã€‚</li>
          <li>é »ç‡ = high ä¸” Budget åš´æ ¼ â†’ ç›¡é‡ Runtime â†’ Spine â†’ Videoã€‚</li>
        </ul>
      </section>

      <!-- C. å››å¤§ç®¡ç·šæµç¨‹ -->
      <section id="flows" class="panel">
        <h2>C. å››å¤§ç®¡ç·šæµç¨‹æ¦‚è¦½</h2>
        <p>æ‰€æœ‰æ¨¡å¼å…±ç”¨ã€Œéœ€æ±‚ â†’ è¦æ ¼ â†’ ç”Ÿæˆ â†’ è©•ä¼° â†’ å¾Œè™•ç† â†’ æ‰“åŒ… â†’ Manifest â†’ QA â†’ ç™¼ä½ˆã€ä¸»å¹¹ï¼Œå·®ç•°åœ¨ <strong>ç”Ÿæˆ + å¾Œè™•ç† + äº¤ä»˜ç‰©</strong>ã€‚</p>
        <div class="flow-diagram">
          <div class="flow-row">
            <div class="flow-node"><strong>éœ€æ±‚æ”¶é›†</strong><span class="small">ç©æ³•ç¯€é» & è¦–è¦ºèªæ„</span></div>
            <div class="flow-node"><strong>Gemini è¦åŠƒ</strong><span class="small">èªæ„çŸ©é™£ / Prompt</span></div>
            <div class="flow-node"><strong>ç”Ÿæˆ</strong><span class="small">Veo / Spine / DSL</span></div>
            <div class="flow-node"><strong>è‡ªå‹•è©•ä¼°</strong><span class="small">è§£æåº¦ / äº®åº¦ / Loop</span></div>
            <div class="flow-node"><strong>å¾Œè™•ç†</strong><span class="small">æŠ½å¹€ / Alpha / keyframes</span></div>
            <div class="flow-node"><strong>æ‰“åŒ…</strong><span class="small">Sprite / JSON / YAML</span></div>
            <div class="flow-node"><strong>Manifest</strong><span class="small">meta / hash</span></div>
            <div class="flow-node"><strong>QA</strong><span class="small">æŒ‡æ¨™èˆ‡è¦ç¯„</span></div>
            <div class="flow-node"><strong>ç™¼ä½ˆ</strong><span class="small">CDN / Bundle</span></div>
          </div>
        </div>

        <h3>å„æ¨¡å¼å·®ç•°ç„¦é»</h3>
        <div class="table-wrap"><table>
          <thead><tr><th>é¢å‘</th><th>Video / Sprite</th><th>Spine</th><th>Runtime</th><th>Hybrid</th></tr></thead>
          <tbody>
            <tr><td>ç”Ÿæˆå·¥å…·</td><td>Veo + ffmpeg</td><td>Spine Editor / AI éª¨æ¶</td><td>DSL â†’ å¼•æ“</td><td>æ··åˆä¸Šè¿°</td></tr>
            <tr><td>å¾Œè™•ç†</td><td>Loop ä¿®è£œ / Alpha æ“·å–</td><td>éª¨æ¶çµæ§‹æª¢æŸ¥</td><td>Keyframe åˆç†åŒ–</td><td>åŒæ­¥å°é½Š</td></tr>
            <tr><td>æ ¸å¿ƒ QA</td><td>loopSeamRMS / ä¸­å¿ƒæ¼‚ç§»</td><td>boneCoverage</td><td>eventSync</td><td>peak å°é½Š</td></tr>
            <tr><td>ç‰ˆæœ¬æ§åˆ¶</td><td>vN (æ¸²æŸ“)</td><td>éª¨æ¶/å‹•ä½œ vN</td><td>DSL vN</td><td>ä¸‰é … hash</td></tr>
            <tr><td>é™ç´šç­–ç•¥</td><td>é™å¹€/å£“ç¸®</td><td>æ¸›éª¨éª¼</td><td>é™ä½é »ç‡</td><td>å›æ‹†ä¸‰ç¨ç«‹</td></tr>
          </tbody></table></div>
      </section>

      <!-- D. è¦æ ¼ & Artifact -->
      <section id="specs" class="panel">
        <h2>D. è¦æ ¼ & Artifact ç®¡ç†</h2>
        <h3>D.1 ä¸»è¦è³‡æ–™çµæ§‹</h3>
        <div class="grid cols-3">
          <div class="card"><h4>Effect Spec (YAML)</h4><p>æè¿°å–®ä¸€å‹•æ…‹ï¼šèªæ„ã€æ™‚é•·ã€fpsã€é¡è‰²ã€perfBudgetã€variantCountã€‚</p><div class="tag-row"><span class="tag" data-variant="type">author</span><span class="tag">ç‰ˆæœ¬åŒ–</span></div></div>
          <div class="card"><h4>Catalog</h4><p>èšåˆ id åˆ—è¡¨ + è·¯å¾‘ï¼Œä¾›æ‰¹æ¬¡è™•ç†èˆ‡ CLI ä½¿ç”¨ã€‚</p><div class="tag-row"><span class="tag" data-variant="type">batch</span></div></div>
          <div class="card"><h4>Manifest</h4><p>ç™¼ä½ˆäº¤ä»˜ï¼š<code>id, path, memoryCost, deliveryType, hash</code>ã€‚</p><div class="tag-row"><span class="tag" data-variant="type">runtime</span></div></div>
          <div class="card"><h4>Runtime DSL</h4><p>Tween / Shader / event æ™‚åºèˆ‡ keyframesã€‚</p><div class="tag-row"><span class="tag">å¯å£“ç¸®</span></div></div>
          <div class="card"><h4>Hybrid Manifest</h4><p>å°è£ video + skeleton + runtimeSpec + syncã€‚</p></div>
          <div class="card"><h4>QA Report</h4><p>å­˜æ”¾è¨ˆç®—çµæœï¼šloopSeamRMS, luminancePeakTime, boneCoverageã€‚</p></div>
        </div>

        <h3>D.2 Manifest æ“´å……ç¤ºä¾‹</h3>
        <pre class="code">{
  "id": "symbol_win_lion_v2",
  "deliveryType": "hybrid",
  "video": {"path": "animations/symbol/win/lion/v2/core.webm", "fps":30, "loop":false},
  "runtimeSpec": "runtime_specs/symbol_win_lion_v2.yaml",
  "skeleton": {"path":"skeletons/symbol_lion.json", "entry":"idle"},
  "perf": {"memoryKB": 412, "gpuMs": 0.45},
  "hash": "sha256:a912...",
  "qa": {"loopSeamRMS":0.0, "centerDriftPct":2.1}
}</pre>

        <h3>D.3 DSL ç¯„ä¾‹ (Runtime)</h3>
        <pre class="code">id: symbol_win_lion_runtime_v2
bindTo: SYM_Lion
fps: 60
tracks:
  - type: tween
    target: root
    prop: scale
    kf:
      - { t:0.00, v:1.00, ease:cubicOut }
      - { t:0.08, v:1.09 }
      - { t:0.24, v:1.02 }
      - { t:0.46, v:1.07 }
      - { t:0.60, v:1.00 }
  - type: shader
    target: mat.glow
    uniform: sweepPos
    kf: [{t:0.00,v:0.0},{t:0.32,v:1.0},{t:0.60,v:1.2}]
perf:
  maxInstances: 30
  warnMs: 3.0</pre>

        <details class="slim"><summary>æ¬„ä½å°ç…§èˆ‡ä½œç”¨ (å±•é–‹)</summary>
          <div class="table-wrap"><table>
            <thead><tr><th>æ¬„ä½</th><th>ä¾†æº</th><th>ç”¨é€”</th><th>ç®¡ç·šéšæ®µ</th></tr></thead>
            <tbody>
              <tr><td>semanticKeywords</td><td>Spec</td><td>èªæ„æ¯”å°</td><td>Evaluate</td></tr>
              <tr><td>perfBudgetKB</td><td>Spec</td><td>é«”ç©é ç®—</td><td>Evaluate / Pack</td></tr>
              <tr><td>variantCount</td><td>Spec</td><td>ç”Ÿæˆè®Šé«”æ•¸</td><td>Generate</td></tr>
              <tr><td>layering</td><td>Spec</td><td>å±¤/é™ç´šç­–ç•¥</td><td>Manifest</td></tr>
              <tr><td>audioSyncPoints</td><td>Spec</td><td>äº‹ä»¶å°é½Š</td><td>Hybrid Sync</td></tr>
              <tr><td>deliveryType</td><td>Decision Helper</td><td>æ¨¡å¼è¾¨è­˜</td><td>Pack/Manifest</td></tr>
              <tr><td>hash</td><td>Build</td><td>ç‰ˆæœ¬å®Œæ•´æ€§</td><td>Release</td></tr>
            </tbody></table></div>
        </details>
      </section>

      <!-- E. Prompt Library -->
      <section id="prompts" class="panel">
        <h2>E. Prompt Library (ç²¾é¸æ¨¡æ¿)</h2>
        <p>ä¿æŒçµæ§‹ï¼š<strong>Subject + Motion + Camera + Lighting + Style + Timing + Technical</strong>ã€‚ç¤ºä¾‹ç¯€éŒ„ï¼š</p>
        <h3>ç¬¦è™Ÿå‘½ä¸­ (Symbol Win)</h3>
        <pre class="code">Generate a short slot symbol win animation.
Subject: {symbol_description}
Action: energetic burst, subtle 8% scale pulse, gold rune sweep.
Camera: locked orthographic.
Lighting: high contrast rim + warm key.
Style: stylized realism, crisp edges.
Timing: 0.6-0.8s @30fps, emphasis frames: 4,10,14.
Goal: consistent centroid, clean alpha.</pre>
        <h3>èƒŒæ™¯å¾ªç’° (Loop Background)</h3>
        <pre class="code">Create a seamless atmospheric loop background.
Theme: {environment_theme}
Motion: low-medium cyclical parallax.
Length: 6s @24fps.
Loop: seamless first-last frame continuity.
Avoid: distracting focal bursts.</pre>
        <h3>Big Win / Mega Win</h3>
        <pre class="code">Generate a celebratory big win cinematic.
Elements: central emblem + radial golden rays + layered coin burst.
Camera: 5% slow push-in.
Phasing: 0-0.5 build, 0.5-1.6 cascade, 1.6-2.5 settle shimmer.
Duration: 2.5s.
Ensure: no clipping highlights, stable center.</pre>
      </section>

      <!-- F. è‡ªå‹•åŒ– / CLI -->
      <section id="automation" class="panel">
        <h2>F. è‡ªå‹•åŒ– / CLI Pipeline</h2>
        <h3>æ ¸å¿ƒéª¨æ¶</h3>
        <pre class="code">for eff in catalog.effects:
  prompt = gemini_plan(eff)
  clips = veo_generate(prompt, variants=eff.variantCount)
  chosen = select_best(clips, rules=eff.qaRules)
  if chosen:
    if eff.deliveryType in ['video','hybrid']:
      frames = extract_frames(chosen)
      sheet = build_spritesheet(frames)
    if eff.deliveryType in ['runtime','hybrid']:
      dsl = build_runtime_spec(eff)
    pack_and_manifest(eff, artifacts=[sheet,dsl,chosen])
    qa_report = run_qa(eff)
    update_catalog(eff.id, qa=qa_report)</pre>
        <h3>å»ºè­° CLI ä»»å‹™</h3>
        <div class="table-wrap"><table>
          <thead><tr><th>æŒ‡ä»¤</th><th>ç›®çš„</th><th>ç‹€æ…‹</th></tr></thead>
          <tbody>
            <tr><td>gen_prompt</td><td>è¼¸å‡ºèªæ„åŒ– Prompt</td><td>å·²å¯¦ä½œ</td></tr>
            <tr><td>generate_from_layers</td><td>æ¨å°éª¨æ¶ â†’ Spine</td><td>å·²å¯¦ä½œ</td></tr>
            <tr><td>export_hybrid_manifest</td><td>çµ„åˆ Hybrid</td><td>å·²å¯¦ä½œ</td></tr>
            <tr><td>validate_spec</td><td>è¦æ ¼å®Œæ•´æ€§/é¡å‹</td><td>å·²å¯¦ä½œ</td></tr>
            <tr><td>analyze_video_loop</td><td>Loop èª¤å·® (RMS)</td><td>TODO</td></tr>
            <tr><td>build_manifest</td><td>hash / meta èšåˆ</td><td>TODO</td></tr>
            <tr><td>decision_helper</td><td>æ‰¹æ¬¡æ¨è«– deliveryType</td><td>TODO</td></tr>
          </tbody></table></div>
      </section>

      <!-- G. å“è³ª & æ•ˆèƒ½ -->
      <section id="quality" class="panel">
        <h2>G. å“è³ª & æ•ˆèƒ½æ²»ç†</h2>
        <h3>G.1 æŒ‡æ¨™çŸ©é™£</h3>
        <div class="table-wrap"><table>
          <thead><tr><th>æŒ‡æ¨™</th><th>èªªæ˜</th><th>é–€æª»</th><th>é©ç”¨</th></tr></thead>
          <tbody>
            <tr><td>loopSeamRMS</td><td>é¦–å°¾å·® RMS</td><td>&lt; 2.0</td><td>Video / Hybrid</td></tr>
            <tr><td>centerDriftPct</td><td>ä¸­å¿ƒæ¼‚ç§»%</td><td>&lt;= 5%</td><td>All</td></tr>
            <tr><td>alphaIntegrity</td><td>Alpha é‚Šç·£ä¹¾æ·¨åº¦</td><td>&gt;= 0.95</td><td>Video / Sprite</td></tr>
            <tr><td>boneCoverage</td><td>éª¨æ¶è¦†è“‹ç‡</td><td>&gt;= 0.95</td><td>Spine / Hybrid</td></tr>
            <tr><td>runtimeKeyframes</td><td>Keyframe ç¸½æ•¸</td><td>&lt; 180</td><td>Runtime / Hybrid</td></tr>
            <tr><td>uniformUpdateRate</td><td>Shader æ›´æ–°é »ç‡</td><td>&lt; 50/s</td><td>Runtime / Hybrid</td></tr>
            <tr><td>memoryKB</td><td>å–®è³‡ç”¢è¨˜æ†¶é«”</td><td>ä¾åˆ†é¡é ç®—</td><td>All</td></tr>
            <tr><td>luminancePeakTime</td><td>äº®åº¦å³°å€¼æ™‚é–“</td><td>Â±0.06s å°é½Š</td><td>Hybrid</td></tr>
          </tbody></table></div>

        <h3>G.2 QA Checklist (æœ€å°å¥—ä»¶)</h3>
        <ul>
          <li>è§£æåº¦ / FPS æª¢æŸ¥</li>
          <li>Loop èª¤å·® & Alpha é‚Šç·£</li>
          <li>ä¸­å¿ƒç©©å®š (bounding box)</li>
          <li>é«”ç© â‰¤ perfBudgetKB</li>
          <li>äº‹ä»¶ / éŸ³æ•ˆåŒæ­¥ (å¦‚æœ‰)</li>
          <li>Manifest ä¸€è‡´æ€§ (id / path / hash)</li>
        </ul>

        <h3>G.3 é™ç´šç­–ç•¥ç´¢å¼•</h3>
        <div class="grid cols-3">
          <div class="card"><h4>Video</h4><p>æŠ½å¹€â†’æ¸›å¹€ç‡â†’æé«˜ CRFâ†’æ”¹ sprite å±€éƒ¨ã€‚</p></div>
          <div class="card"><h4>Spine</h4><p>åˆä½µ bone / ç§»é™¤è£é£¾ slot / é™è²¼åœ–è§£æåº¦ã€‚</p></div>
          <div class="card"><h4>Runtime</h4><p>æ¸› keyframe / é™ uniform æ›´æ–°é »ç‡ / ç§»é™¤ç²’å­ã€‚</p></div>
        </div>
      </section>

      <!-- H. é¢¨éšª & ç‰ˆæœ¬ -->
      <section id="risk" class="panel">
        <h2>H. é¢¨éšª & ç‰ˆæœ¬æ²»ç†</h2>
        <h3>H.1 é¢¨éšªè¡¨</h3>
        <div class="table-wrap"><table>
          <thead><tr><th>é¢¨éšª</th><th>ç·©è§£</th><th>å›æ»¾</th></tr></thead>
          <tbody>
            <tr><td>Veo ç”¢å‡ºä¸ç©©</td><td>å¤šç¨®å­ + é–¾å€¼éæ¿¾</td><td>å› v(n-1)</td></tr>
            <tr><td>é¢¨æ ¼æ¼‚ç§»</td><td>åƒè€ƒå½±æ ¼ + style embedding</td><td>é–å®šå‰ç‰ˆ embedding</td></tr>
            <tr><td>é«”ç©è†¨è„¹</td><td>é è­¦å ±è¡¨</td><td>æ‰¹æ¬¡å£“ç¸® / æŠ½å¹€</td></tr>
            <tr><td>Loop æ¥ç¸«</td><td>crossfade / optical flow</td><td>æš«é™ç‚ºéœæ…‹</td></tr>
            <tr><td>æ’­æ”¾å¡é “</td><td>é è¼‰ç­–ç•¥ / é™ FPS</td><td>ä½éšè³‡ç”¢åŒ…</td></tr>
          </tbody></table></div>

        <h3>H.2 ç‰ˆæœ¬æ¨™è¨˜</h3>
        <ul>
          <li><code>_vN</code>ï¼šè¦–è¦ºæˆ– DSL çµæ§‹è®Šæ›´ã€‚</li>
          <li><code>hash</code>ï¼šVideo ^ Skeleton ^ RuntimeSpecã€‚</li>
          <li>Manifest <code>versionTag</code> è®Šå‹•æ™‚å¯«å…¥ ChangeLogã€‚</li>
        </ul>

        <h3>H.3 è¿­ä»£ç­–ç•¥</h3>
        <ol>
          <li>æ”¶é›† QA å ±å‘Š â†’ æ‰¾å‡ºé«˜é«”ç©ä½ä½¿ç”¨é »ç‡è³‡ç”¢ã€‚</li>
          <li>Decision Helper å†è©•ä¼°æ˜¯å¦å¯ç¨‹åºåŒ–æ›¿æ›ã€‚</li>
          <li>å»ºç«‹ <code>deprecated = true</code> æ¨™è¨˜ â†’ å»¶å¾Œç§»é™¤ã€‚</li>
          <li>æ¯é€±ç”¢å‡º <code>pipeline_metrics.json</code>ï¼šå¹³å‡è¿­ä»£ã€é€šéç‡ã€é«”ç©åˆ†å¸ƒã€‚</li>
        </ol>
      </section>

      <!-- é™„éŒ„ -->
      <section id="appendix" class="panel">
        <h2>é™„éŒ„ (Reference)</h2>
        <details class="slim"><summary>åŸå§‹ Prompt æ“´å±•åˆ†é¡</summary>
          <p>å¯ä¾è¦–è¦ºèƒ½é‡ï¼š<code>lowAmbient / midAction / burstCinematic</code> åˆ†ç´šä¿®é£¾è©ã€‚</p>
        </details>
        <details class="slim"><summary>æŒ‡æ¨™è¨ˆç®—ç‰‡æ®µï¼ˆPseudo)</summary>
          <pre class="code">def loop_seam_rms(first_frame, last_frame):
  diff = (first_frame.astype(float) - last_frame.astype(float)) ** 2
  return np.sqrt(diff.mean())</pre>
        </details>
        <details class="slim"><summary>Decision Helper è¦å‰‡ç°¡åŒ–</summary>
          <pre class="code">if complexity=='high' and peak=='high': video_or_hybrid()
elif interactive=='high': runtime_or_spine()
elif loop=='long' and budget < 300: runtime_or_spine()
else: video_if_budget_allows()</pre>
        </details>
        <details class="slim"><summary>Hybrid Sync è¦é»</summary>
          <ul><li>å–äº®åº¦å³°å€¼ time â†’ å°é½Š runtime peak trackã€‚</li><li>Spine idle æ™‚é•·èˆ‡å½±ç‰‡å¾ªç’° LCMã€‚</li><li>äº‹ä»¶ç¯€é» Â±0.05s å…æ”¶ã€‚</li></ul>
        </details>
        <details class="slim"><summary>é™ç´šè·¯å¾‘åƒè€ƒ</summary>
          <ul><li>Big Win H â†’ (å½±ç‰‡ä½å¹€ç‡ + Runtime)</li><li>Transition V â†’ Spine overlay + ç°¡åŒ– shader</li></ul>
        </details>
      </section>
    </main>
  </div>

  <footer>Â© 2025 Slot Game AI Pipeline Team Â· Refactored v2 Â· Gemini 2.5 + Veo 3</footer>

  <script>
    // Sidebar active highlight
    const links = Array.from(document.querySelectorAll('#sidebar a'));
    const observer = new IntersectionObserver(entries => {
      entries.forEach(e => {
        if (e.isIntersecting) {
          links.forEach(l => l.classList.toggle('active', l.getAttribute('href').slice(1) === e.target.id));
        }
      });
    }, { rootMargin: '0px 0px -70% 0px', threshold: 0.1 });
    document.querySelectorAll('main section').forEach(sec => observer.observe(sec));

    // Filters for decision table
    const filterBtns = document.querySelectorAll('#typeFilters button');
    const decisionRows = document.querySelectorAll('#decisionTable tbody tr');
    filterBtns.forEach(btn => btn.addEventListener('click', () => {
      filterBtns.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      const f = btn.dataset.filter;
      decisionRows.forEach(r => {
        if (!f || f==='reset') { r.hidden = false; return; }
        r.hidden = !r.dataset.type.includes(f);
      });
    }));

    // Decision Helper logic
    const runBtn = document.getElementById('runDecision');
    runBtn?.addEventListener('click', () => {
      const complexity = document.getElementById('complexity').value;
      const loop = document.getElementById('loop').value;
      const budget = parseInt(document.getElementById('budget').value, 10) || 0;
      const interactive = document.getElementById('interactive').value;
      const freq = document.getElementById('freq').value;
      const peak = document.getElementById('peak').value;

      let type = 'video';
      const reasons = [];
      // Rule evaluation
      if (complexity === 'high' && peak === 'high') { type = 'video'; reasons.push('é«˜è¦–è¦ºè¤‡é›œ + é«˜å³°å€¼ â†’ éœ€è¦é æ¸²æŸ“å“è³ª'); }
      if (interactive === 'high') { type = 'runtime'; reasons.push('é«˜äº’å‹•/åƒæ•¸åŒ– â†’ ç¨‹åºåŒ–å„ªå…ˆ'); }
      if (loop === 'long' && budget < 300) { type = (interactive !== 'low') ? 'runtime' : 'spine'; reasons.push('é•· Loop + åš´æ ¼é«”ç© â†’ Spine/Runtime'); }
      if (type === 'video' && budget < 350 && peak !== 'high') { type = 'hybrid'; reasons.push('é«”ç©ç·Šå¼µä¸”éé«˜å³°å€¼ â†’ Hybrid æ··åˆç¯€çœ'); }
      if (type === 'runtime' && peak === 'high' && complexity !== 'low') { type = 'hybrid'; reasons.push('ç¨‹åºåŒ–ä¸è¶³ä»¥æ”¯æ’è¦–è¦º â†’ Hybrid'); }
      if (freq === 'high' && type === 'video' && budget < 600) { type = 'hybrid'; reasons.push('é«˜é »æ’­æ”¾ + é«”ç©é—œæ³¨ â†’ Hybrid'); }

      // Next step suggestions
      const next = {
        video: 'ä½¿ç”¨ Prompt æ¨¡æ¿ (E ç¯€) â†’ Veo ç”Ÿæˆ â†’ å¾Œè™•ç† (Loop/Alpha) â†’ Manifestã€‚',
        spine: 'å»ºç«‹éª¨æ¶ + Idle å‹•ä½œ â†’ è¦†è“‹ç‡æª¢æŸ¥ â†’ Export â†’ Manifest skeletonã€‚',
        runtime: 'ç”¨ Spec è¡ç”Ÿ DSL â†’ å»ºç«‹ Tween/Shader â†’ äº‹ä»¶å°é½Š QAã€‚',
        hybrid: 'å…ˆç”¢å½±ç‰‡ä¸»å±¤ â†’ ç”Ÿæˆ DSL / Skeleton è£œå¼· â†’ Sync å³°å€¼æ™‚é–“ â†’ Hybrid Manifestã€‚'
      };

      document.getElementById('decisionOutput').hidden = false;
      document.getElementById('resultType').textContent = type.toUpperCase();
      document.getElementById('resultReason').innerHTML = reasons.map(r => 'â€¢ ' + r).join('<br>');
      document.getElementById('resultNext').textContent = next[type];
    });
  </script>
</body>
</html>
