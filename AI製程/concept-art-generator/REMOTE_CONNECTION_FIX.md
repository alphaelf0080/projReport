# ğŸ”§ é ç«¯é€£ç·šå•é¡Œä¿®æ­£æŒ‡å—

## ğŸ“‹ å•é¡Œèªªæ˜

é ç«¯ä¸»æ©Ÿç„¡æ³•é€£æ¥åˆ°å¾Œç«¯æœå‹™ (port 3010)ï¼Œå‡ºç¾ `TCP connect failed` éŒ¯èª¤ã€‚

## âœ… è§£æ±ºæ–¹æ¡ˆç¸½çµ

å·²å®Œæˆä»¥ä¸‹ä¿®æ­£ï¼š

### 1. **å¾Œç«¯é…ç½®** (`main_gemini.py`)
- âœ… æ”¹ç”¨ port **3010** (åŸç‚º 8000)
- âœ… ç¶å®šåˆ° `0.0.0.0` (å…è¨±æ‰€æœ‰ç¶²è·¯ä»‹é¢é€£æ¥)
- âœ… æ·»åŠ ç¶²è·¯è³‡è¨Šé¡¯ç¤ºï¼ˆå•Ÿå‹•æ™‚é¡¯ç¤ºæœ¬æ©Ÿ IP å’Œé€£æ¥æ–¹å¼ï¼‰

### 2. **å‰ç«¯é…ç½®** (`app_gemini.js`)
- âœ… å‹•æ…‹ API é…ç½®ï¼ˆè‡ªå‹•æª¢æ¸¬æœ¬æ©Ÿæˆ–é ç«¯è¨ªå•ï¼‰
- âœ… å¢å¼·éŒ¯èª¤è¨ºæ–·è¨Šæ¯
- âœ… æ·»åŠ è©³ç´°çš„é€£ç·šç‹€æ…‹é¡¯ç¤º

### 3. **å·¥å…·è…³æœ¬**
- âœ… `setup_firewall.ps1` - è‡ªå‹•è¨­å®š Windows é˜²ç«ç‰†
- âœ… `diagnose_network.py` - ç¶²è·¯é€£ç·šè¨ºæ–·å·¥å…·
- âœ… `quick_start.bat` - ä¸€éµå•Ÿå‹•å’Œæ¸¬è©¦å·¥å…·

---

## ğŸš€ å¿«é€Ÿä¿®æ­£æ­¥é©Ÿ

### **æ­¥é©Ÿ 1ï¼šè¨­å®šé˜²ç«ç‰†ï¼ˆå¿…é ˆï¼‰**

**æ–¹æ³• Aï¼šä½¿ç”¨è…³æœ¬ï¼ˆæ¨è–¦ï¼‰**

1. ä»¥**ç®¡ç†å“¡èº«ä»½**é–‹å•Ÿ PowerShell
2. åŸ·è¡Œï¼š
   ```powershell
   cd c:\projects\projReport\AIè£½ç¨‹\concept-art-generator\backend
   .\setup_firewall.ps1
   ```

**æ–¹æ³• Bï¼šæ‰‹å‹•åŸ·è¡Œå‘½ä»¤**

ä»¥**ç®¡ç†å“¡èº«ä»½**åŸ·è¡Œ PowerShellï¼š
```powershell
# æ·»åŠ é˜²ç«ç‰†è¦å‰‡
netsh advfirewall firewall add rule name="Backend 3010 In" dir=in action=allow protocol=TCP localport=3010 profile=any

# é©—è­‰è¦å‰‡
netsh advfirewall firewall show rule name="Backend 3010 In"
```

---

### **æ­¥é©Ÿ 2ï¼šè¨ºæ–·ç¶²è·¯ç‹€æ…‹**

```bash
cd c:\projects\projReport\AIè£½ç¨‹\concept-art-generator\backend
python diagnose_network.py
```

é€™æœƒæª¢æŸ¥ï¼š
- âœ… æœ¬æ©Ÿ IP åœ°å€
- âœ… Port 3010 æ˜¯å¦é–‹å•Ÿ
- âœ… HTTP é€£æ¥æ˜¯å¦æ­£å¸¸
- âœ… é˜²ç«ç‰†è¦å‰‡æ˜¯å¦è¨­å®š

---

### **æ­¥é©Ÿ 3ï¼šå•Ÿå‹•å¾Œç«¯æœå‹™**

```bash
cd c:\projects\projReport\AIè£½ç¨‹\concept-art-generator\backend
python main_gemini.py
```

**é æœŸè¼¸å‡ºï¼š**
```
======================================================================
ğŸš€ å•Ÿå‹• Gemini Concept Art Generator
======================================================================
ä¸»æ©Ÿåç¨±: YOUR-COMPUTER
æœ¬æ©Ÿ IP:  192.168.12.75
ç¶å®šä»‹é¢: 0.0.0.0 (æ‰€æœ‰ç¶²è·¯ä»‹é¢)
ç›£è½ç«¯å£: 3010
======================================================================
ğŸ“ æœ¬æ©Ÿè¨ªå•: http://localhost:3010
ğŸ“ å€ç¶²è¨ªå•: http://192.168.12.75:3010
ğŸ“ å¥åº·æª¢æŸ¥: http://192.168.12.75:3010/api/health
======================================================================
ğŸ’¡ é ç«¯é€£ç·šæ³¨æ„äº‹é …ï¼š
   1. ç¢ºèªé˜²ç«ç‰†å·²é–‹å•Ÿ port 3010
   2. åŸ·è¡Œä»¥ä¸‹å‘½ä»¤æ·»åŠ é˜²ç«ç‰†è¦å‰‡ (éœ€ç®¡ç†å“¡æ¬Šé™)ï¼š
      netsh advfirewall firewall add rule name="Backend 3010" dir=in action=allow protocol=TCP localport=3010
   3. å‰ç«¯é…ç½®ä½¿ç”¨: http://192.168.12.75:3010
======================================================================
INFO:     Uvicorn running on http://0.0.0.0:3010 (Press CTRL+C to quit)
```

---

### **æ­¥é©Ÿ 4ï¼šæ¸¬è©¦æœ¬æ©Ÿé€£æ¥**

åœ¨**æ–°çš„çµ‚ç«¯è¦–çª—**åŸ·è¡Œï¼š

```bash
# æ¸¬è©¦å¥åº·æª¢æŸ¥ç«¯é»
curl http://localhost:3010/api/health
```

**é æœŸå›æ‡‰ï¼š**
```json
{
  "status": "healthy",
  "gemini_agent": true,
  "image_generator": true,
  "active_sessions": 0
}
```

---

### **æ­¥é©Ÿ 5ï¼šæ¸¬è©¦é ç«¯é€£æ¥**

åœ¨**é ç«¯ä¸»æ©Ÿ**ä¸ŠåŸ·è¡Œï¼š

```powershell
# æ¸¬è©¦ TCP é€£æ¥
Test-NetConnection -ComputerName 192.168.12.75 -Port 3010

# æ¸¬è©¦ HTTP é€£æ¥
curl http://192.168.12.75:3010/api/health
```

**é æœŸè¼¸å‡ºï¼š**
```
TcpTestSucceeded : True
```

---

### **æ­¥é©Ÿ 6ï¼šæ›´æ–°å‰ç«¯é…ç½®**

å‰ç«¯ `app_gemini.js` å·²è‡ªå‹•é…ç½®ï¼Œä½†è«‹ç¢ºèª **BACKEND_SERVER_IP**ï¼š

```javascript
// åœ¨ app_gemini.js é–‹é ­
const BACKEND_SERVER_IP = '192.168.12.75';  // ğŸ‘ˆ ç¢ºèªé€™æ˜¯æ­£ç¢ºçš„ IP
const BACKEND_PORT = 3010;
```

---

### **æ­¥é©Ÿ 7ï¼šå•Ÿå‹•å‰ç«¯ä¸¦æ¸¬è©¦**

```bash
cd c:\projects\projReport\AIè£½ç¨‹\concept-art-generator\frontend
python -m http.server 3000
```

è¨ªå•ï¼š
- æœ¬æ©Ÿï¼š`http://localhost:3000/index_gemini.html`
- é ç«¯ï¼š`http://192.168.12.75:3000/index_gemini.html`

---

## ğŸ› ï¸ ä½¿ç”¨å¿«é€Ÿå•Ÿå‹•å·¥å…·

æˆ‘å€‘æä¾›äº†ä¸€å€‹æ•´åˆå·¥å…·ï¼ŒåŒ…å«æ‰€æœ‰åŠŸèƒ½ï¼š

```bash
cd c:\projects\projReport\AIè£½ç¨‹\concept-art-generator\backend
quick_start.bat
```

**åŠŸèƒ½é¸å–®ï¼š**
```
[1] ğŸ”§ è¨­å®šé˜²ç«ç‰†ï¼ˆéœ€è¦ç®¡ç†å“¡æ¬Šé™ï¼‰
[2] ğŸ” è¨ºæ–·ç¶²è·¯é€£ç·š
[3] ğŸš€ å•Ÿå‹•å¾Œç«¯æœå‹™ (port 3010)
[4] ğŸŒ å•Ÿå‹•å‰ç«¯æœå‹™ (port 3000)
[5] ğŸ§ª æ¸¬è©¦å¾Œç«¯é€£ç·š
[6] ğŸ“ é¡¯ç¤ºé…ç½®è³‡è¨Š
[0] âŒ çµæŸ
```

---

## ğŸ” æ•…éšœæ’é™¤

### **å•é¡Œ 1ï¼šé˜²ç«ç‰†è¦å‰‡ç„¡æ•ˆ**

**ç—‡ç‹€ï¼š** é ç«¯ä»ç„¡æ³•é€£æ¥

**è§£æ±ºï¼š**
1. æª¢æŸ¥è¦å‰‡æ˜¯å¦çœŸçš„ç”Ÿæ•ˆï¼š
   ```powershell
   netsh advfirewall firewall show rule name=all | findstr 3010
   ```

2. æª¢æŸ¥é˜²ç«ç‰†ç‹€æ…‹ï¼š
   ```powershell
   Get-NetFirewallProfile | Select-Object Name, Enabled
   ```

3. æš«æ™‚é—œé–‰å…¬ç”¨ç¶²è·¯é˜²ç«ç‰†æ¸¬è©¦ï¼ˆåƒ…è¨ºæ–·ç”¨ï¼‰ï¼š
   ```powershell
   Set-NetFirewallProfile -Profile Public -Enabled False
   ```

4. æ¸¬è©¦å®Œå¾Œè¨˜å¾—é‡æ–°å•Ÿç”¨ï¼š
   ```powershell
   Set-NetFirewallProfile -Profile Public -Enabled True
   ```

---

### **å•é¡Œ 2ï¼šPort å·²è¢«å ç”¨**

**ç—‡ç‹€ï¼š** å•Ÿå‹•æ™‚å‡ºç¾ `Address already in use`

**è§£æ±ºï¼š**
```powershell
# æŸ¥çœ‹èª°å ç”¨äº† port 3010
netstat -ano | findstr :3010

# çµ‚æ­¢è©²ç¨‹åºï¼ˆå°‡ <PID> æ›¿æ›ç‚ºå¯¦éš›çš„ PIDï¼‰
taskkill /PID <PID> /F
```

---

### **å•é¡Œ 3ï¼šå¾Œç«¯ç¶å®šåˆ°éŒ¯èª¤çš„ä»‹é¢**

**ç—‡ç‹€ï¼š** `netstat` é¡¯ç¤º `127.0.0.1:3010` è€Œé `0.0.0.0:3010`

**æª¢æŸ¥ï¼š**
```powershell
netstat -ano | findstr :3010
```

**æ­£ç¢ºè¼¸å‡ºæ‡‰è©²æ˜¯ï¼š**
```
TCP    0.0.0.0:3010           0.0.0.0:0              LISTENING       12345
```

**å¦‚æœé¡¯ç¤º `127.0.0.1:3010`ï¼Œæª¢æŸ¥ `main_gemini.py` çš„ `host` åƒæ•¸æ˜¯å¦ç‚º `"0.0.0.0"`**

---

### **å•é¡Œ 4ï¼šIP åœ°å€è®Šæ›´**

**ç—‡ç‹€ï¼š** é›»è…¦ IP è®Šäº†ï¼Œå‰ç«¯é€£ä¸ä¸Š

**è§£æ±ºï¼š**
1. åŸ·è¡Œè¨ºæ–·å·¥å…·ç¢ºèªæ–° IPï¼š
   ```bash
   python diagnose_network.py
   ```

2. æ›´æ–°å‰ç«¯é…ç½®ï¼š
   ```javascript
   const BACKEND_SERVER_IP = 'æ–°çš„IPåœ°å€';
   ```

---

## ğŸ“ æª¢æŸ¥æ¸…å–®

å®Œæˆæ‰€æœ‰ä¿®æ­£å¾Œï¼Œè«‹ç¢ºèªï¼š

- [ ] é˜²ç«ç‰†è¦å‰‡å·²æ·»åŠ ï¼ˆport 3010ï¼‰
- [ ] å¾Œç«¯åœ¨ port 3010 é‹è¡Œ
- [ ] `netstat -ano | findstr :3010` é¡¯ç¤º `0.0.0.0:3010`
- [ ] æœ¬æ©Ÿå¯è¨ªå• `http://localhost:3010/api/health`
- [ ] æœ¬æ©Ÿå¯è¨ªå• `http://192.168.12.75:3010/api/health`
- [ ] å‰ç«¯ `BACKEND_SERVER_IP` é…ç½®æ­£ç¢º
- [ ] é ç«¯ä¸»æ©Ÿå¯ ping é€šä¼ºæœå™¨
- [ ] é ç«¯ä¸»æ©Ÿ `Test-NetConnection` æˆåŠŸ
- [ ] é ç«¯ä¸»æ©Ÿå¯è¨ªå•å¥åº·æª¢æŸ¥ç«¯é»
- [ ] å‰ç«¯é é¢ç‹€æ…‹åˆ—é¡¯ç¤ºã€Œâœ… å·²é€£ç·šã€

---

## ğŸ¯ æœ€çµ‚æ¸¬è©¦

**åœ¨ä¼ºæœå™¨ä¸Šï¼š**
```bash
# 1. å•Ÿå‹•å¾Œç«¯
python main_gemini.py

# 2. åœ¨æ–°çµ‚ç«¯æ¸¬è©¦
curl http://localhost:3010/api/health
```

**åœ¨é ç«¯ä¸»æ©Ÿä¸Šï¼š**
```powershell
# 1. æ¸¬è©¦é€£é€šæ€§
Test-NetConnection -ComputerName 192.168.12.75 -Port 3010

# 2. æ¸¬è©¦ API
curl http://192.168.12.75:3010/api/health

# 3. ç€è¦½å™¨è¨ªå•
# http://192.168.12.75:3000/index_gemini.html
```

---

## ğŸ“ ä»æœ‰å•é¡Œï¼Ÿ

å¦‚æœå®Œæˆä»¥ä¸Šæ‰€æœ‰æ­¥é©Ÿä»ç„¡æ³•é€£æ¥ï¼Œè«‹æä¾›ï¼š

1. `diagnose_network.py` çš„å®Œæ•´è¼¸å‡º
2. `netstat -ano | findstr :3010` çš„çµæœ
3. é˜²ç«ç‰†è¦å‰‡åˆ—è¡¨ï¼š
   ```powershell
   netsh advfirewall firewall show rule name=all | findstr 3010
   ```
4. é ç«¯ä¸»æ©ŸåŸ·è¡Œ `Test-NetConnection` çš„å®Œæ•´è¼¸å‡º
5. ç€è¦½å™¨é–‹ç™¼è€…å·¥å…· (F12) çš„ Console å’Œ Network æ¨™ç±¤æˆªåœ–

---

## âœ… ä¿®æ­£å®Œæˆ

ç¾åœ¨æ‚¨çš„ç³»çµ±æ‡‰è©²ï¼š
- âœ… å¾Œç«¯åœ¨ port 3010 é‹è¡Œä¸¦æ¥å—å¤–éƒ¨é€£æ¥
- âœ… é˜²ç«ç‰†å…è¨± port 3010 é€šè¨Š
- âœ… å‰ç«¯è‡ªå‹•é©é…æœ¬æ©Ÿæˆ–é ç«¯è¨ªå•
- âœ… æä¾›å®Œæ•´çš„è¨ºæ–·å’Œæ¸¬è©¦å·¥å…·

ç¥ä½¿ç”¨é †åˆ©ï¼ğŸ‰
