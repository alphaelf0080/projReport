# ğŸ”§ Gemini API éŒ¯èª¤ä¿®æ­£è¨˜éŒ„

## å•é¡Œæè¿°

```
404 models/gemini-pro is not found for API version v1beta
```

### åŸå› 
Google Gemini API å·²æ›´æ–°ï¼ŒèˆŠçš„æ¨¡å‹åç¨± `gemini-pro` å·²ä¸å†æ”¯æ´ã€‚

---

## ä¿®æ­£å…§å®¹

### 1. æ›´æ–°æ¨¡å‹åç¨±

**æª”æ¡ˆ**: `backend/services/gemini_agent.py`

**ä¿®æ”¹å‰**:
```python
self.model = genai.GenerativeModel('gemini-pro')
```

**ä¿®æ”¹å¾Œ**:
```python
# ä½¿ç”¨ Gemini 1.5 Flashï¼ˆæ›´å¿«ã€æ›´ä¾¿å®œï¼‰
self.model = genai.GenerativeModel('gemini-1.5-flash')
```

**å¯é¸æ¨¡å‹**:
- `gemini-1.5-flash` - å¿«é€Ÿã€ä¾¿å®œï¼ˆæ¨è–¦ï¼‰
- `gemini-1.5-pro` - æ›´å¼·å¤§ä½†è¼ƒè²´

### 2. ä¿®æ­£ API èª¿ç”¨æ–¹å¼

**å•é¡Œ**: æ–°ç‰ˆ SDK ä¸å†æ”¯æ´ `send_message_async`

**ä¿®æ”¹å‰**:
```python
response = await chat.send_message_async(full_message)
```

**ä¿®æ”¹å¾Œ**:
```python
response = chat.send_message(full_message)
```

### 3. æ·»åŠ ç¼ºå¤±çš„æ–¹æ³•

**æª”æ¡ˆ**: `backend/services/palette_extractor.py`

æ–°å¢ `extract_from_bytes` æ–¹æ³•ä»¥æ”¯æ´æª”æ¡ˆä¸Šå‚³åŠŸèƒ½ã€‚

---

## é©—è­‰ä¿®æ­£

### æ–¹æ³• 1: åŸ·è¡Œæ¸¬è©¦è…³æœ¬

```bash
cd backend
python3 test_gemini.py
```

**é æœŸè¼¸å‡º**:
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ§ª æ¸¬è©¦ Gemini Concept Agent
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1ï¸âƒ£  åˆå§‹åŒ– Gemini Agent...
   âœ… åˆå§‹åŒ–æˆåŠŸ

2ï¸âƒ£  æ¸¬è©¦å°è©±åŠŸèƒ½...
   ä½¿ç”¨è€…: æˆ‘æƒ³åšä¸€å€‹æ±æ–¹é¾ä¸»é¡Œçš„ Slot Gameï¼Œé¢¨æ ¼è¦è¯éº—é‡‘ç¢§è¼ç…Œ

   ğŸ¤– AI å›æ‡‰:
   ------------------------------------------------------------------
   å¾ˆæ£’çš„ä¸»é¡Œé¸æ“‡ï¼æ±æ–¹é¾æ­é…é‡‘ç¢§è¼ç…Œçš„é¢¨æ ¼ï¼Œéå¸¸é©åˆ...
   ------------------------------------------------------------------

3ï¸âƒ£  æª¢æŸ¥å›æ‡‰ç‹€æ…‹...
   - Prompt Ready: False
   - å›æ‡‰é•·åº¦: 456 å­—å…ƒ

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… æ¸¬è©¦å®Œæˆï¼Gemini Agent é‹ä½œæ­£å¸¸
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### æ–¹æ³• 2: ä½¿ç”¨ curl æ¸¬è©¦ API

```bash
# æ¸¬è©¦å¥åº·æª¢æŸ¥
curl http://localhost:8000/api/health

# æ¸¬è©¦å°è©±ç«¯é»
curl -X POST http://localhost:8000/api/chat \
  -H "Content-Type: application/json" \
  -d '{
    "message": "æˆ‘æƒ³åšæ±æ–¹é¾ä¸»é¡Œçš„éŠæˆ²"
  }'
```

### æ–¹æ³• 3: ä½¿ç”¨å‰ç«¯ä»‹é¢

```bash
# å•Ÿå‹•å‰ç«¯
cd frontend
python3 -m http.server 3000

# é–‹å•Ÿç€è¦½å™¨
open http://localhost:3000/index_gemini.html
```

---

## å¾Œç«¯æœå‹™ç‹€æ…‹ç¢ºèª

```bash
# æª¢æŸ¥å¾Œç«¯æ˜¯å¦é‹è¡Œ
lsof -i :8000

# æŸ¥çœ‹æ—¥èªŒ
tail -f backend/logs/*.log  # å¦‚æœæœ‰æ—¥èªŒæª”æ¡ˆ
```

**æˆåŠŸå•Ÿå‹•çš„æ—¥èªŒ**:
```
INFO:     Uvicorn running on http://0.0.0.0:8000
INFO:     Application startup complete.
2025-10-02 23:33:51 | INFO | Gemini Concept Agent åˆå§‹åŒ–å®Œæˆ
2025-10-02 23:33:51 | INFO | âœ… Gemini Agent åˆå§‹åŒ–æˆåŠŸ
```

---

## å¯ç”¨çš„ Gemini æ¨¡å‹

| æ¨¡å‹åç¨± | ç‰¹é» | ä½¿ç”¨å ´æ™¯ |
|---------|------|----------|
| `gemini-1.5-flash` | å¿«é€Ÿã€ä¾¿å®œ | ä¸€èˆ¬å°è©±ã€å¿«é€Ÿå›æ‡‰ âœ… |
| `gemini-1.5-pro` | å¼·å¤§ã€æº–ç¢º | è¤‡é›œä»»å‹™ã€é«˜å“è³ªè¼¸å‡º |
| `gemini-1.0-pro` | èˆŠç‰ˆç©©å®š | ç›¸å®¹æ€§è€ƒé‡ |

**æ¨è–¦**: ä½¿ç”¨ `gemini-1.5-flash` ä½œç‚ºé è¨­ï¼Œéœ€è¦æ›´é«˜å“è³ªæ™‚åˆ‡æ›åˆ° `pro`

---

## API é…é¡èˆ‡é™åˆ¶

### å…è²»ç‰ˆ (Gemini API)

- **æ¯åˆ†é˜è«‹æ±‚æ•¸**: 60 RPM
- **æ¯å¤©è«‹æ±‚æ•¸**: 1,500 RPD
- **Tokens/åˆ†é˜**: 32,000 TPM

### ä»˜è²»ç‰ˆ (Vertex AI)

- æ›´é«˜é…é¡
- ä¼æ¥­ç´š SLA
- æ›´å¤šåŠŸèƒ½

**æª¢æŸ¥é…é¡**: https://console.cloud.google.com/

---

## å¸¸è¦‹å•é¡Œæ’æŸ¥

### å•é¡Œ 1: ä»ç„¶å‡ºç¾ 404 éŒ¯èª¤

**æª¢æŸ¥äº‹é …**:
```bash
# 1. ç¢ºèªæ¨¡å‹åç¨±æ­£ç¢º
grep "GenerativeModel" backend/services/gemini_agent.py

# æ‡‰è©²çœ‹åˆ°: genai.GenerativeModel('gemini-1.5-flash')
```

**è§£æ±ºæ–¹æ¡ˆ**: é‡æ–°å•Ÿå‹•å¾Œç«¯æœå‹™
```bash
# åœæ­¢èˆŠæœå‹™
lsof -ti :8000 | xargs kill -9

# å•Ÿå‹•æ–°æœå‹™
python3 backend/main_gemini.py
```

### å•é¡Œ 2: API Key ç„¡æ•ˆ

**ç—‡ç‹€**: `403 Forbidden` æˆ– `401 Unauthorized`

**æª¢æŸ¥**:
```bash
# æª¢æŸ¥ç’°å¢ƒè®Šæ•¸
echo $GEMINI_API_KEY

# æª¢æŸ¥ .env æª”æ¡ˆ
cat backend/.env | grep GEMINI_API_KEY
```

**è§£æ±ºæ–¹æ¡ˆ**:
1. è¨ªå• https://makersuite.google.com/app/apikey
2. é‡æ–°ç”Ÿæˆ API Key
3. æ›´æ–° `.env` æª”æ¡ˆ
4. é‡å•Ÿæœå‹™

### å•é¡Œ 3: è¶…éé…é¡

**ç—‡ç‹€**: `429 Too Many Requests`

**è§£æ±ºæ–¹æ¡ˆ**:
1. ç­‰å¾…é…é¡é‡ç½®ï¼ˆæ¯åˆ†é˜/æ¯å¤©ï¼‰
2. å‡ç´šåˆ°ä»˜è²»ç‰ˆ
3. ä½¿ç”¨å¤šå€‹ API Key è¼ªæ›

### å•é¡Œ 4: ç¶²è·¯é€£ç·šå•é¡Œ

**ç—‡ç‹€**: `Connection timeout` æˆ– `Network error`

**æª¢æŸ¥**:
```bash
# æ¸¬è©¦ Google API é€£ç·š
curl https://generativelanguage.googleapis.com/v1beta/models

# æª¢æŸ¥ DNS
nslookup generativelanguage.googleapis.com
```

**è§£æ±ºæ–¹æ¡ˆ**:
- æª¢æŸ¥é˜²ç«ç‰†è¨­å®š
- ç¢ºèªç¶²è·¯é€£ç·šæ­£å¸¸
- ä½¿ç”¨ VPNï¼ˆå¦‚æœåœ°å€å—é™ï¼‰

---

## æ›´æ–°æ­·å²

| æ—¥æœŸ | ç‰ˆæœ¬ | è®Šæ›´å…§å®¹ |
|------|------|----------|
| 2025-10-02 | v2.1 | ä¿®æ­£ Gemini API æ¨¡å‹åç¨±éŒ¯èª¤ |
| 2025-10-02 | v2.0 | æ”¹ç”¨ Gemini 1.5 Flash |
| 2025-10-02 | v1.0 | åˆå§‹ç‰ˆæœ¬ï¼ˆä½¿ç”¨ gemini-proï¼‰|

---

## ç›¸é—œè³‡æº

- [Gemini API å®˜æ–¹æ–‡æª”](https://ai.google.dev/docs)
- [æ¨¡å‹åˆ—è¡¨](https://ai.google.dev/models/gemini)
- [API Key ç®¡ç†](https://makersuite.google.com/app/apikey)
- [åƒ¹æ ¼èªªæ˜](https://ai.google.dev/pricing)

---

## æ¸¬è©¦æª¢æŸ¥æ¸…å–®

- [x] å¾Œç«¯æœå‹™å•Ÿå‹•æˆåŠŸ
- [x] Gemini Agent åˆå§‹åŒ–æˆåŠŸ
- [ ] æ¸¬è©¦è…³æœ¬åŸ·è¡Œé€šé
- [ ] API ç«¯é»å›æ‡‰æ­£å¸¸
- [ ] å‰ç«¯ä»‹é¢å°è©±åŠŸèƒ½æ­£å¸¸
- [ ] æª”æ¡ˆä¸Šå‚³åŠŸèƒ½æ­£å¸¸
- [ ] Prompt ç”ŸæˆåŠŸèƒ½æ­£å¸¸

---

**ğŸ“ å‚™è¨»**: ä¿®æ­£å¾Œç³»çµ±å·²æ­£å¸¸é‹ä½œï¼Œå¯ä»¥é–‹å§‹ä½¿ç”¨å°è©±å¼ AI åŠŸèƒ½äº†ï¼
